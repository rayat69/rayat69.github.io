/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(sd){o(sd)}}function u(t){try{a(r.throw(t))}catch(sd){o(sd)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(sd){o=[6,sd],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function s(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=u(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var a=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function h(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(sd){return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var f=function(t){function n(e,r,i){var o=t.call(this,r)||this;return o.code=e,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,l.prototype.create),o}return e(n,t),n}(Error),l=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?p(o,r):"Error",u=this.serviceName+": "+s+" ("+i+").",a=new f(i,u,r);return a},t}();function p(t,e){return t.replace(d,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var d=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function y(t,e){var n=new g(t,e);return n.subscribe.bind(n)}var g=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=m),void 0===r.error&&(r.error=m),void 0===r.complete&&(r.complete=m);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(sd){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(sd){"undefined"!=typeof console&&console.error&&console.error(sd)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function m(){}var b=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),w=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new a;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(sd){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=n({identifier:"[DEFAULT]",optional:!1},t),r=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(r);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(sd){if(i)return null;throw sd}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService("[DEFAULT]")}catch(sd){}try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=o(i.value,2),u=s[0],a=s[1],c=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService(c);a.resolve(h)}catch(sd){}}}catch(f){e={error:f}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(s(s([],o(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),o(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t="[DEFAULT]"),this.instances.has(t)},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var E,_=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new w(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function I(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var T,N,A=[];(N=T||(T={}))[N.DEBUG=0]="DEBUG",N[N.VERBOSE=1]="VERBOSE",N[N.INFO=2]="INFO",N[N.WARN=3]="WARN",N[N.ERROR=4]="ERROR",N[N.SILENT=5]="SILENT";var S,D={debug:T.DEBUG,verbose:T.VERBOSE,info:T.INFO,warn:T.WARN,error:T.ERROR,silent:T.SILENT},O=T.INFO,x=((E={})[T.DEBUG]="log",E[T.VERBOSE]="log",E[T.INFO]="info",E[T.WARN]="warn",E[T.ERROR]="error",E),P=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=x[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,I(["["+i+"]  "+t.name+":"],n))}},k=function(){function t(t){this.name=t,this._logLevel=O,this._logHandler=P,this._userLogHandler=null,A.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in T))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?D[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,I([this,T.DEBUG],t)),this._logHandler.apply(this,I([this,T.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,I([this,T.VERBOSE],t)),this._logHandler.apply(this,I([this,T.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,I([this,T.INFO],t)),this._logHandler.apply(this,I([this,T.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,I([this,T.WARN],t)),this._logHandler.apply(this,I([this,T.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,I([this,T.ERROR],t)),this._logHandler.apply(this,I([this,T.ERROR],t))},t}();function C(t){A.forEach((function(e){e.setLogLevel(t)}))}var L,R=((S={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",S["bad-app-name"]="Illegal App name: '{$appName}",S["duplicate-app"]="Firebase App named '{$appName}' already exists",S["app-deleted"]="Firebase App named '{$appName}' already deleted",S["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",S["invalid-log-argument"]="First argument to `onLog` must be null or a function.",S),V=new l("app","Firebase",R),U=((L={})["@firebase/app"]="fire-core",L["@firebase/analytics"]="fire-analytics",L["@firebase/auth"]="fire-auth",L["@firebase/database"]="fire-rtdb",L["@firebase/functions"]="fire-fn",L["@firebase/installations"]="fire-iid",L["@firebase/messaging"]="fire-fcm",L["@firebase/performance"]="fire-perf",L["@firebase/remote-config"]="fire-rc",L["@firebase/storage"]="fire-gcs",L["@firebase/firestore"]="fire-fst",L["fire-js"]="fire-js",L["firebase-wrapper"]="fire-js-all",L),M=new k("@firebase/app"),j=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=u(void 0,t),this.container=new _(e.name),this._addComponent(new b("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(sd){M.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,sd)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw V.create("app-deleted",{appName:this.name_})},t}();j.prototype.name&&j.prototype.options||j.prototype.delete||console.log("dc");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function F(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw V.create("bad-app-name",{appName:String(s)});if(v(e,s))throw V.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=U[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),u=e.match(/\s|\//);if(s||u){var a=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&a.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&u&&a.push("and"),u&&a.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void M.warn(a.join(" "))}o(new b(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:C,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw V.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=D[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:T[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=A;r<i.length;r++)n(i[r])}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e)},apps:null,SDK_VERSION:"8.3.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!v(e,t=t||"[DEFAULT]"))throw V.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return M.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw V.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&u(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++){var f=h[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var q=function t(){var e=F(j);return e.INTERNAL=n(n({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){u(e,t)},createSubscribe:y,ErrorFactory:l,deepExtend:u}),e}(),z=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){M.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var B=self.firebase.SDK_VERSION;B&&B.indexOf("LITE")>=0&&M.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var G=q.initializeApp;q.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return h()&&M.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),G.apply(void 0,t)};var H,Y,K=q;(H=K).INTERNAL.registerComponent(new b("platform-logger",(function(t){return new z(t)}),"PRIVATE")),H.registerVersion("@firebase/app","0.6.16",Y),H.registerVersion("fire-js","");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
K.registerVersion("firebase","8.3.0","app");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var Q=function(t,e){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function X(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var W,J="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Z=Z||{},$=J||self;function tt(){}function et(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function nt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var rt="closure_uid_"+(1e9*Math.random()>>>0),it=0;function ot(t,e,n){return t.call.apply(t.bind,arguments)}function st(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ut(t,e,n){return(ut=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ot:st).apply(null,arguments)}function at(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ct(){return Date.now()}function ht(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ft(){this.j=this.j,this.i=this.i}ft.prototype.j=!1,ft.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,rt)&&t[rt]||(t[rt]=++it))},ft.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var lt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},pt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function dt(t){return Array.prototype.concat.apply([],arguments)}function vt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function yt(t){return/^[\s\xa0]*$/.test(t)}var gt,mt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function bt(t,e){return-1!=t.indexOf(e)}function wt(t,e){return t<e?-1:t>e?1:0}t:{var Et=$.navigator;if(Et){var _t=Et.userAgent;if(_t){gt=_t;break t}}gt=""}function It(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Tt(t){var e={};for(var n in t)e[n]=t[n];return e}var Nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function At(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Nt.length;o++)n=Nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function St(t){return St[" "](t),t}St[" "]=tt;var Dt,Ot,xt=bt(gt,"Opera"),Pt=bt(gt,"Trident")||bt(gt,"MSIE"),kt=bt(gt,"Edge"),Ct=kt||Pt,Lt=bt(gt,"Gecko")&&!(bt(gt.toLowerCase(),"webkit")&&!bt(gt,"Edge"))&&!(bt(gt,"Trident")||bt(gt,"MSIE"))&&!bt(gt,"Edge"),Rt=bt(gt.toLowerCase(),"webkit")&&!bt(gt,"Edge");function Vt(){var t=$.document;return t?t.documentMode:void 0}t:{var Ut="",Mt=(Ot=gt,Lt?/rv:([^\);]+)(\)|;)/.exec(Ot):kt?/Edge\/([\d\.]+)/.exec(Ot):Pt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ot):Rt?/WebKit\/(\S+)/.exec(Ot):xt?/(?:Version)[ \/]?(\S+)/.exec(Ot):void 0);if(Mt&&(Ut=Mt?Mt[1]:""),Pt){var jt=Vt();if(null!=jt&&jt>parseFloat(Ut)){Dt=String(jt);break t}}Dt=Ut}var Ft,qt={};function zt(t){return function(t,e){var n=qt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=mt(String(Dt)).split("."),r=mt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=wt(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||wt(0==s[2].length,0==u[2].length)||wt(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}if($.document&&Pt){var Bt=Vt();Ft=Bt||(parseInt(Dt,10)||void 0)}else Ft=void 0;var Gt=Ft,Ht=!Pt||9<=Number(Gt),Yt=Pt&&!zt("9"),Kt=function(){if(!$.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{$.addEventListener("test",tt,e),$.removeEventListener("test",tt,e)}catch(n){}return t}();function Qt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Xt(t,e){if(Qt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Lt){t:{try{St(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Wt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Qt.prototype.b=function(){this.defaultPrevented=!0},ht(Xt,Qt);var Wt={2:"touch",3:"pen",4:"mouse"};Xt.prototype.b=function(){Xt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Yt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Jt="closure_listenable_"+(1e6*Math.random()|0),Zt=0;function $t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Zt,this.Y=this.Z=!1}function te(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ee(t){this.src=t,this.a={},this.b=0}function ne(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=lt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(te(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function re(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ee.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=re(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new $t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var ie="closure_lm_"+(1e6*Math.random()|0),oe={};function se(t,e,n,r,i){if(r&&r.once)return ae(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)se(t,e[o],n,r,i);return null}return n=ye(n),t&&t[Jt]?t.va(e,n,nt(r)?!!r.capture:!!r,i):ue(t,e,n,!1,r,i)}function ue(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=nt(i)?!!i.capture:!!i;if(s&&!Ht)return null;var u=de(t);if(u||(t[ie]=u=new ee(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=pe,e=Ht?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Kt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(fe(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function ae(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)ae(t,e[o],n,r,i);return null}return n=ye(n),t&&t[Jt]?t.wa(e,n,nt(r)?!!r.capture:!!r,i):ue(t,e,n,!0,r,i)}function ce(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ce(t,e[o],n,r,i);else r=nt(r)?!!r.capture:!!r,n=ye(n),t&&t[Jt]?(t=t.c,(e=String(e).toString())in t.a&&(-1<(n=re(o=t.a[e],n,r,i))&&(te(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=de(t))&&(e=t.a[e.toString()],t=-1,e&&(t=re(e,n,r,i)),(n=-1<t?e[t]:null)&&he(n))}function he(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Jt])ne(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fe(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=de(e))?(ne(n,t),0==n.b&&(n.src=null,e[ie]=null)):te(t)}}}function fe(t){return t in oe?oe[t]:oe[t]="on"+t}function le(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&he(t),n.call(r,e)}function pe(t,e){if(t.Y)return!0;if(!Ht){if(!e)t:{e=["window","event"];for(var n=$,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return le(t,e=new Xt(e,this))}return le(t,new Xt(e,this))}function de(t){return(t=t[ie])instanceof ee?t:null}var ve="__closure_events_fn_"+(1e9*Math.random()>>>0);function ye(t){return"function"==typeof t?t:(t[ve]||(t[ve]=function(e){return t.handleEvent(e)}),t[ve])}function ge(){ft.call(this),this.c=new ee(this),this.J=this,this.C=null}function me(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Qt(e,t);else if(e instanceof Qt)e.target=e.target||t;else{var i=e;At(e=new Qt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=be(s,r,!0,e)&&i}if(i=be(s=e.a=t,r,!0,e)&&i,i=be(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=be(s=e.a=n[o],r,!1,e)&&i}function be(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&ne(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}ht(ge,ft),ge.prototype[Jt]=!0,(W=ge.prototype).addEventListener=function(t,e,n,r){se(this,t,e,n,r)},W.removeEventListener=function(t,e,n,r){ce(this,t,e,n,r)},W.G=function(){if(ge.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)te(n[r]);delete e.a[t],e.b--}}this.C=null},W.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},W.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var we=$.JSON.stringify;function Ee(){this.b=this.a=null}var _e,Ie=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ne}),(function(t){t.reset()}));function Te(){var t=Oe,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ne(){this.next=this.b=this.a=null}function Ae(t){$.setTimeout((function(){throw t}),0)}function Se(t,e){_e||function(){var t=$.Promise.resolve(void 0);_e=function(){t.then(xe)}}(),De||(_e(),De=!0),Oe.add(t,e)}Ee.prototype.add=function(t,e){var n=Ie.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ne.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ne.prototype.reset=function(){this.next=this.b=this.a=null};var De=!1,Oe=new Ee;function xe(){for(var t;t=Te();){try{t.a.call(t.b)}catch(n){Ae(n)}var e=Ie;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}De=!1}function Pe(t,e){ge.call(this),this.b=t||1,this.a=e||$,this.f=ut(this.Za,this),this.g=ct()}function ke(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Ce(t,e,n){if("function"==typeof t)n&&(t=ut(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ut(t.handleEvent,t)}return 2147483647<Number(e)?-1:$.setTimeout(t,e||0)}function Le(t){t.a=Ce((function(){t.a=null,t.c&&(t.c=!1,Le(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}ht(Pe,ge),(W=Pe.prototype).aa=!1,W.M=null,W.Za=function(){if(this.aa){var t=ct()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),me(this,"tick"),this.aa&&(ke(this),this.start()))}},W.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=ct())},W.G=function(){Pe.X.G.call(this),ke(this),delete this.a};var Re=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Le(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&($.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(ft);function Ve(t){ft.call(this),this.b=t,this.a={}}ht(Ve,ft);var Ue=[];function Me(t,e,n,r){Array.isArray(n)||(n&&(Ue[0]=n.toString()),n=Ue);for(var i=0;i<n.length;i++){var o=se(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function je(t){It(t.a,(function(t,e){this.a.hasOwnProperty(e)&&he(t)}),t),t.a={}}function Fe(){this.a=!0}function qe(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return we(n)}catch(u){return e}}(t,n)+(r?" "+r:"")}))}Ve.prototype.G=function(){Ve.X.G.call(this),je(this)},Ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Fe.prototype.info=function(){};var ze={},Be=null;function Ge(){return Be=Be||new ge}function He(t){Qt.call(this,ze.Fa,t)}function Ye(t){var e=Ge();me(e,new He(e,t))}function Ke(t,e){Qt.call(this,ze.STAT_EVENT,t),this.stat=e}function Qe(t){var e=Ge();me(e,new Ke(e,t))}function Xe(t){Qt.call(this,ze.Ga,t)}function We(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return $.setTimeout((function(){t()}),e)}ze.Fa="serverreachability",ht(He,Qt),ze.STAT_EVENT="statevent",ht(Ke,Qt),ze.Ga="timingevent",ht(Xe,Qt);var Je={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ze={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function $e(){}function tn(t){var e;return(e=t.a)||(e=t.a={}),e}function en(){}$e.prototype.a=null;var nn,rn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function on(){Qt.call(this,"d")}function sn(){Qt.call(this,"c")}function un(){}function an(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Ve(this),this.P=cn,t=Ct?125:void 0,this.R=new Pe(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}ht(on,Qt),ht(sn,Qt),ht(un,$e),nn=new un;var cn=45e3,hn={},fn={};function ln(t,e,n){t.H=1,t.i=Ln(Dn(e)),t.j=n,t.I=!0,pn(t,null)}function pn(t,e){t.u=ct(),yn(t),t.l=Dn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Kn(n.b,"t",r),t.D=0,t.a=qr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Re(ut(t.Ca,t,t.a),t.O)),Me(t.J,t.a,"readystatechange",t.Xa),e=t.B?Tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ye(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function dn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=vn(t,n);if(i==fn){4==e&&(t.h=4,Qe(14),r=!1),qe(t.c,t.f,null,"[Incomplete Response]");break}if(i==hn){t.h=4,Qe(15),qe(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}qe(t.c,t.f,i,null),En(t,i)}4==e&&0==n.length&&(t.h=1,Qe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Cr(e),e.F=!0,Qe(11))):(qe(t.c,t.f,n,"[Invalid Chunked Response]"),wn(t),bn(t))}function vn(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?fn:(n=Number(e.substring(n,r)),isNaN(n)?hn:(r+=1)+n>e.length?fn:(e=e.substr(r,n),t.D=r+n,e))}function yn(t){t.T=ct()+t.P,gn(t,t.P)}function gn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=We(ut(t.Va,t),e)}function mn(t){t.o&&($.clearTimeout(t.o),t.o=null)}function bn(t){0==t.g.v||t.A||Vr(t.g,t)}function wn(t){mn(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ke(t.R),je(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function En(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||tr(n.b,t)))if(n.I=t.N,!t.C&&tr(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Rr(n),Tr(n)}kr(n),Qe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=We(ut(n.Sa,n),6e3));if(1>=$n(n.b)&&n.ea){try{n.ea()}catch(y){}n.ea=void 0}}else Mr(n,11)}else if((t.C||n.a==t)&&Rr(n),!yt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(bt(h,"spdy")||bt(h,"quic")||bt(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(er(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,Cn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=ct()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=Fr(a,a.C?a.ga:null,a.fa),p.C){nr(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(mn(d),yn(d)),a.a=p}else Pr(a);0<n.g.length&&Sr(n)}else"stop"!=i[0]&&"close"!=i[0]||Mr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Mr(n,7):Ir(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Ye(4)}catch(y){}}function _n(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(et(t)||"string"==typeof t)pt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(et(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(et(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function In(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof In)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Tn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Nn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Nn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(W=an.prototype).setTimeout=function(t){this.P=t},W.Xa=function(t){t=t.target;var e=this.F;e&&3==br(t)?e.f():this.Ca(t)},W.Ca=function(t){try{if(t==this.a)t:{var e=br(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Ct&&!this.a.$())){this.A||4!=e||7==n||Ye(8==n||0>=r?3:2),mn(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!yt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Qe(12),wn(this),bn(this);break t}qe(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,En(this,a)}this.I?(dn(this,e,o),Ct&&this.b&&3==e&&(Me(this.J,this.R,"tick",this.Wa),this.R.start())):(qe(this.c,this.f,o,null),En(this,o)),4==e&&wn(this),this.b&&!this.A&&(4==e?Vr(this.g,this):(this.b=!1,yn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Qe(12)):(this.h=0,Qe(13)),wn(this),bn(this)}}}catch(c){}},W.Wa=function(){if(this.a){var t=br(this.a),e=this.a.$();this.D<e.length&&(mn(this),dn(this,t,e),this.b&&4!=t&&yn(this))}},W.cancel=function(){this.A=!0,wn(this)},W.Va=function(){this.o=null;var t=ct();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Ye(3),Qe(17)),wn(this),this.h=2,bn(this)):gn(this,this.T-t)},(W=In.prototype).K=function(){Tn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},W.L=function(){return Tn(this),this.a.concat()},W.get=function(t,e){return Nn(this.b,t)?this.b[t]:e},W.set=function(t,e){Nn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},W.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var An=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Sn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Sn){this.a=void 0!==e?e:t.a,On(this,t.f),this.j=t.j,xn(this,t.c),Pn(this,t.h),this.g=t.g,e=t.b;var n=new Bn;n.c=e.c,e.a&&(n.a=new In(e.a),n.b=e.b),kn(this,n),this.i=t.i}else t&&(n=String(t).match(An))?(this.a=!!e,On(this,n[1]||"",!0),this.j=Rn(n[2]||""),xn(this,n[3]||"",!0),Pn(this,n[4]),this.g=Rn(n[5]||"",!0),kn(this,n[6]||"",!0),this.i=Rn(n[7]||"")):(this.a=!!e,this.b=new Bn(null,this.a))}function Dn(t){return new Sn(t)}function On(t,e,n){t.f=n?Rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function xn(t,e,n){t.c=n?Rn(e,!0):e}function Pn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function kn(t,e,n){e instanceof Bn?(t.b=e,function(t,e){e&&!t.f&&(Gn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Hn(this,e),Kn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Vn(e,qn)),t.b=new Bn(e,t.a))}function Cn(t,e,n){t.b.set(e,n)}function Ln(t){return Cn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ct()).toString(36)),t}function Rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Vn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Sn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Vn(e,Mn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Vn(e,Mn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Vn(n,"/"==n.charAt(0)?Fn:jn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Vn(n,zn)),t.join("")};var Mn=/[#\/\?@]/g,jn=/[#\?:]/g,Fn=/[#\?]/g,qn=/[#\?@]/g,zn=/#/g;function Bn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Gn(t){t.a||(t.a=new In,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Hn(t,e){Gn(t),e=Qn(t,e),Nn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Nn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Tn(t)))}function Yn(t,e){return Gn(t),e=Qn(t,e),Nn(t.a.b,e)}function Kn(t,e,n){Hn(t,e),0<n.length&&(t.c=null,t.a.set(Qn(t,e),vt(n)),t.b+=n.length)}function Qn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(W=Bn.prototype).add=function(t,e){Gn(this),this.c=null,t=Qn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},W.forEach=function(t,e){Gn(this),this.a.forEach((function(n,r){pt(n,(function(n){t.call(e,n,r,this)}),this)}),this)},W.L=function(){Gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},W.K=function(t){Gn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=dt(e,this.a.get(Qn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=dt(e,t[n])}return e},W.set=function(t,e){return Gn(this),this.c=null,Yn(this,t=Qn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},W.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},W.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Xn=function(t,e){this.b=t,this.a=e};function Wn(t){this.g=t||Jn,$.PerformanceNavigationTiming?t=0<(t=$.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!($.ia&&$.ia.ya&&$.ia.ya()&&$.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Jn=10;function Zn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function $n(t){return t.b?1:t.a?t.a.size:0}function tr(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function er(t,e){t.a?t.a.add(e):t.b=e}function nr(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function rr(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=X(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return vt(t.c)}function ir(){}function or(){this.a=new ir}function sr(t,e,n){var r=n||"";try{_n(t,(function(t,n){var i=t;nt(t)&&(i=we(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(sd){throw e.push(r+"type="+encodeURIComponent("_badmap")),sd}}function ur(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Wn.prototype.cancel=function(){var t,e;if(this.c=rr(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=X(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},ir.prototype.stringify=function(t){return $.JSON.stringify(t,void 0)},ir.prototype.parse=function(t){return $.JSON.parse(t,void 0)};var ar=$.JSON.parse;function cr(t){ge.call(this),this.headers=new In,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=hr,this.D=this.F=!1}ht(cr,ge);var hr="",fr=/^https?$/i,lr=["POST","PUT"];function pr(t){return"content-type"==t.toLowerCase()}function dr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,vr(t),gr(t)}function vr(t){t.u||(t.u=!0,me(t,"complete"),me(t,"error"))}function yr(t){if(t.b&&void 0!==Z&&(!t.s[1]||4!=br(t)||2!=t.W()))if(t.l&&4==br(t))Ce(t.za,0,t);else if(me(t,"readystatechange"),4==br(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(An)[1]||null;if(!o&&$.self&&$.self.location){var s=$.self.location.protocol;o=s.substr(0,s.length-1)}i=!fr.test(o?o.toLowerCase():"")}e=i}if(e)me(t,"complete"),me(t,"success");else{t.h=6;try{var u=2<br(t)?t.a.statusText:""}catch(a){u=""}t.f=u+" ["+t.W()+"]",vr(t)}}finally{gr(t)}}}function gr(t,e){if(t.a){mr(t);var n=t.a,r=t.s[0]?tt:null;t.a=null,t.s=null,e||me(t,"ready");try{n.onreadystatechange=r}catch(sd){}}}function mr(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&($.clearTimeout(t.m),t.m=null)}function br(t){return t.a?t.a.readyState:0}function wr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return It(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Cn(t,e,n))}function Er(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _r(t){this.pa=0,this.g=[],this.c=new Fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Er("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Er("baseRetryDelayMs",5e3,t),this.Ra=Er("retryDelaySeedMs",1e4,t),this.Ma=Er("forwardChannelMaxRetries",2,t),this.ma=Er("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Wn(t&&t.concurrentRequestLimit),this.ka=new or,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Ir(t){if(Nr(t),3==t.v){var e=t.R++,n=Dn(t.B);Cn(n,"SID",t.J),Cn(n,"RID",e),Cn(n,"TYPE","terminate"),Or(t,n),(e=new an(t,t.c,e,void 0)).H=2,e.i=Ln(Dn(n)),n=!1,$.navigator&&$.navigator.sendBeacon&&(n=$.navigator.sendBeacon(e.i.toString(),"")),!n&&$.Image&&((new Image).src=e.i,n=!0),n||(e.a=qr(e.g,null),e.a.ba(e.i)),e.u=ct(),yn(e)}jr(t)}function Tr(t){t.a&&(Cr(t),t.a.cancel(),t.a=null)}function Nr(t){Tr(t),t.j&&($.clearTimeout(t.j),t.j=null),Rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&$.clearTimeout(t.h),t.h=null)}function Ar(t,e){t.g.push(new Xn(t.Oa++,e)),3==t.v&&Sr(t)}function Sr(t){Zn(t.b)||t.h||(t.h=!0,Se(t.Ba,t),t.u=0)}function Dr(t,e){var n;n=e?e.f:t.R++;var r=Dn(t.B);Cn(r,"SID",t.J),Cn(r,"RID",n),Cn(r,"AID",t.P),Or(t,r),t.i&&t.l&&wr(r,t.i,t.l),n=new an(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=xr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),er(t.b,n),ln(n,r,e)}function Or(t,e){t.f&&_n({},(function(t,n){Cn(e,n,t)}))}function xr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ut(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{sr(h,s,"req"+c+"_")}catch(f){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Pr(t){t.a||t.j||(t.T=1,Se(t.Aa,t),t.o=0)}function kr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=We(ut(t.Aa,t),Ur(t,t.o)),t.o++,!0)}function Cr(t){null!=t.s&&($.clearTimeout(t.s),t.s=null)}function Lr(t){t.a=new an(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Dn(t.la);Cn(e,"RID","rpc"),Cn(e,"SID",t.J),Cn(e,"CI",t.H?"0":"1"),Cn(e,"AID",t.P),Or(t,e),Cn(e,"TYPE","xmlhttp"),t.i&&t.l&&wr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Ln(Dn(e)),n.j=null,n.I=!0,pn(n,t)}function Rr(t){null!=t.m&&($.clearTimeout(t.m),t.m=null)}function Vr(t,e){var n=null;if(t.a==e){Rr(t),Cr(t),t.a=null;var r=2}else{if(!tr(t.b,e))return;n=e.s,nr(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=ct()-e.u;var i=t.u;me(r=Ge(),new Xe(r,n,e,i)),Sr(t)}else Pr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!($n(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=We(ut(t.Ba,t,e),Ur(t,t.u)),t.u++,0)))}(t,e)||2==r&&kr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Mr(t,5);break;case 4:Mr(t,10);break;case 3:Mr(t,6);break;default:Mr(t,2)}}function Ur(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Mr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ut(t.Ya,t);n||(n=new Sn("//www.google.com/images/cleardot.gif"),$.location&&"http"==$.location.protocol||On(n,"https"),Ln(n)),function(t,e){var n=new Fe;if($.Image){var r=new Image;r.onload=at(ur,n,r,"TestLoadImage: loaded",!0,e),r.onerror=at(ur,n,r,"TestLoadImage: error",!1,e),r.onabort=at(ur,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=at(ur,n,r,"TestLoadImage: timeout",!1,e),$.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Qe(2);t.v=0,t.f&&t.f.ra(e),jr(t),Nr(t)}function jr(t){t.v=0,t.I=-1,t.f&&(0==rr(t.b).length&&0==t.g.length||(t.b.c.length=0,vt(t.g),t.g.length=0),t.f.qa())}function Fr(t,e,n){var r=function(t){return t instanceof Sn?Dn(t):new Sn(t,void 0)}(n);if(""!=r.c)e&&xn(r,e+"."+r.c),Pn(r,r.h);else{var i=$.location;r=function(t,e,n,r){var i=new Sn(null,void 0);return t&&On(i,t),e&&xn(i,e),n&&Pn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&It(t.V,(function(t,e){Cn(r,e,t)})),e=t.A,n=t.na,e&&n&&Cn(r,e,n),Cn(r,"VER",t.ha),Or(t,r),r}function qr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new cr(t.Na)).F=t.C,e}function zr(){}function Br(){if(Pt&&!(10<=Number(Gt)))throw Error("Environmental error: no available transport.")}function Gr(t,e){ge.call(this),this.a=new _r(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!yt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!yt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Kr(this)}function Hr(t){on.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Yr(){sn.call(this),this.status=1}function Kr(t){this.a=t}(W=cr.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?tn(this.H):tn(nn),this.a.onreadystatechange=ut(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void dr(this,o)}t=n||"";var i=new In(this.headers);r&&_n(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=pr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=$.FormData&&t instanceof $.FormData,!(0<=lt(lr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{mr(this),0<this.o&&((this.D=function(t){return Pt&&zt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ut(this.xa,this)):this.m=Ce(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){dr(this,o)}},W.xa=function(){void 0!==Z&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,me(this,"timeout"),this.abort(8))},W.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,me(this,"complete"),me(this,"abort"),gr(this))},W.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),gr(this,!0)),cr.X.G.call(this)},W.za=function(){this.j||(this.A||this.l||this.g?yr(this):this.Ua())},W.Ua=function(){yr(this)},W.W=function(){try{return 2<br(this)?this.a.status:-1}catch(Ot){return-1}},W.$=function(){try{return this.a?this.a.responseText:""}catch(Ot){return""}},W.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ar(e)}},W.ua=function(){return this.h},W.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(W=_r.prototype).ha=8,W.v=1,W.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new an(this,this.c,t,void 0),r=this.l;if(this.O&&(r?At(r=Tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=xr(this,n,e),Cn(i=Dn(this.B),"RID",t),Cn(i,"CVER",22),this.A&&Cn(i,"X-HTTP-Session-Id",this.A),Or(this,i),this.i&&r&&wr(i,this.i,r),er(this.b,n),this.Ia&&Cn(i,"TYPE","init"),this.da?(Cn(i,"$req",e),Cn(i,"SID","null"),n.U=!0,ln(n,i,null)):ln(n,i,e),this.v=2}}else 3==this.v&&(t?Dr(this,t):0==this.g.length||Zn(this.b)||Dr(this))},W.Aa=function(){if(this.j=null,Lr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=We(ut(this.Ta,this),t)}},W.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qe(10),Tr(this),Lr(this))},W.Sa=function(){null!=this.m&&(this.m=null,Tr(this),kr(this),Qe(19))},W.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Qe(2)):(this.c.info("Failed to ping google.com"),Qe(1))},(W=zr.prototype).ta=function(){},W.sa=function(){},W.ra=function(){},W.qa=function(){},W.Ja=function(){},Br.prototype.a=function(t,e){return new Gr(t,e)},ht(Gr,ge),Gr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Qe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Fr(t,null,t.fa),Sr(t)},Gr.prototype.close=function(){Ir(this.a)},Gr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Ar(this.a,e)}else this.l?((e={}).__data__=we(t),Ar(this.a,e)):Ar(this.a,t)},Gr.prototype.G=function(){this.a.f=null,delete this.f,Ir(this.a),delete this.a,Gr.X.G.call(this)},ht(Hr,on),ht(Yr,sn),ht(Kr,zr),Kr.prototype.ta=function(){me(this.a,"a")},Kr.prototype.sa=function(t){me(this.a,new Hr(t))},Kr.prototype.ra=function(t){me(this.a,new Yr(t))},Kr.prototype.qa=function(){me(this.a,"b")},Br.prototype.createWebChannel=Br.prototype.a,Gr.prototype.send=Gr.prototype.h,Gr.prototype.open=Gr.prototype.g,Gr.prototype.close=Gr.prototype.close,Je.NO_ERROR=0,Je.TIMEOUT=8,Je.HTTP_ERROR=6,Ze.COMPLETE="complete",en.EventType=rn,rn.OPEN="a",rn.CLOSE="b",rn.ERROR="c",rn.MESSAGE="d",ge.prototype.listen=ge.prototype.va,cr.prototype.listenOnce=cr.prototype.wa,cr.prototype.getLastError=cr.prototype.Qa,cr.prototype.getLastErrorCode=cr.prototype.ua,cr.prototype.getStatus=cr.prototype.W,cr.prototype.getResponseJson=cr.prototype.Pa,cr.prototype.getResponseText=cr.prototype.$,cr.prototype.send=cr.prototype.ba;var Qr=Je,Xr=Ze,Wr=ze,Jr=10,Zr=11,$r=en,ti=cr,ei=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},ni=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ri=new k("@firebase/firestore");function ii(){return ri.logLevel}function oi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ri.logLevel<=T.DEBUG){var r=e.map(ai);ri.debug.apply(ri,s(["Firestore (8.3.0): "+t],r))}}function si(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ri.logLevel<=T.ERROR){var r=e.map(ai);ri.error.apply(ri,s(["Firestore (8.3.0): "+t],r))}}function ui(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ri.logLevel<=T.WARN){var r=e.map(ai);ri.warn.apply(ri,s(["Firestore (8.3.0): "+t],r))}}function ai(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(n){return t}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.3.0) INTERNAL ASSERTION FAILED: "+t;throw si(e),new Error(e)}function hi(t,e){t||ci()}function fi(t,e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pi=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=li(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function di(t,e){return t<e?-1:t>e?1:0}function vi(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function yi(t){return t+"\0"}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gi=function(){function t(t){this.h=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.h,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},t.prototype.l=function(){return 2*this.h.length},t.prototype._=function(t){return di(this.h,t.h)},t.prototype.isEqual=function(t){return this.h===t.h},t}();gi.T=new gi("");var mi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},bi=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return e(n,t),n}(Error),wi=function(){function t(t){this.I=t}return t.fromBase64String=function(e){try{return new t(gi.fromBase64String(e))}catch(n){throw new bi(mi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},t.fromUint8Array=function(e){return new t(gi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.I.toBase64()},t.prototype.toUint8Array=function(){return this.I.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.I.isEqual(t.I)},t}(),Ei=function(){function t(t){this.uid=t}return t.prototype.m=function(){return null!=this.uid},t.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Ei.UNAUTHENTICATED=new Ei(null),Ei.R=new Ei("google-credentials-uid"),Ei.P=new Ei("first-party-uid");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _i=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},Ii=function(){function t(){this.V=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.p=function(){},t.prototype.v=function(t){this.V=t,t(Ei.UNAUTHENTICATED)},t.prototype.S=function(){this.V=null},t}(),Ti=function(){function t(t){var e=this;this.D=null,this.currentUser=Ei.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then((function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.N!==e?(oi("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(hi("string"==typeof n.accessToken),new _i(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.p=function(){this.forceRefresh=!0},t.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},t.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},t.prototype.$=function(){var t=this.auth&&this.auth.getUid();return hi(null===t||"string"==typeof t),new Ei(t)},t}(),Ni=function(){function t(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=Ei.P}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Ai=function(){function t(t,e){this.F=t,this.O=e}return t.prototype.getToken=function(){return Promise.resolve(new Ni(this.F,this.O))},t.prototype.v=function(t){t(Ei.P)},t.prototype.S=function(){},t.prototype.p=function(){},t}(),Si=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}return t.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},t}();Si.q=-1;var Di=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new bi(mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new bi(mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new bi(mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new bi(mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Oi=function(){function t(t){this.timestamp=t}return t.K=function(e){return new t(e)},t.min=function(){return new t(new Di(0,0))},t.prototype._=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.j=function(){return this.timestamp},t}(),xi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ci(),void 0===n?n=t.length-e:n>t.length-e&&ci(),this.segments=t,this.offset=e,this.G=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.H(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.J(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},t.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},t.prototype.Z=function(){return this.segments[this.offset]},t.prototype.tt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.et=function(){return 0===this.length},t.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},t.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Pi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.J=function(t,e,r){return new n(t,e,r)},n.prototype.rt=function(){return this.it().join("/")},n.prototype.toString=function(){return this.rt()},n.ot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new bi(mi.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new n(r)},n.ct=function(){return new n([])},n}(xi),ki=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ci=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.J=function(t,e,r){return new n(t,e,r)},n.at=function(t){return ki.test(t)},n.prototype.rt=function(){return this.it().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.at(t)||(t="`"+t+"`"),t})).join(".")},n.prototype.toString=function(){return this.rt()},n.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},n.ht=function(){return new n(["__name__"])},n.lt=function(t){for(var e=[],r="",i=0,o=function(){if(0===r.length)throw new bi(mi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new bi(mi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new bi(mi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new bi(mi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)},n.ct=function(){return new n([])},n}(xi),Li=function(){function t(t){this.path=t}return t._t=function(e){return new t(Pi.ot(e))},t.ft=function(e){return new t(Pi.ot(e).Y(5))},t.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Pi.H(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.H=function(t,e){return Pi.H(t.path,e.path)},t.wt=function(t){return t.length%2==0},t.Et=function(e){return new t(new Pi(e.slice()))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ui(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mi=function(){function t(t){this.fields=t,t.sort(Ci.H)}return t.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},t.prototype.isEqual=function(t){return vi(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ji=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(t){if(hi(!!t),"string"==typeof t){var e=0,n=ji.exec(t);if(hi(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qi(t.seconds),nanos:qi(t.nanos)}}function qi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function zi(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Gi(t){var e=t.mapValue.fields.__previous_value__;return Bi(e)?Gi(e):e}function Hi(t){var e=Fi(t.mapValue.fields.__local_write_time__.timestampValue);return new Di(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t){return null==t}function Ki(t){return 0===t&&1/t==-1/0}function Qi(t){return"number"==typeof t&&Number.isInteger(t)&&!Ki(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bi(t)?4:10:ci()}function Wi(t,e){var n,r=Xi(t);if(r!==Xi(e))return!1;switch(r){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Hi(t).isEqual(Hi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Fi(t.timestampValue),r=Fi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return n=e,zi(t.bytesValue).isEqual(zi(n.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return qi(t.geoPointValue.latitude)===qi(e.geoPointValue.latitude)&&qi(t.geoPointValue.longitude)===qi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return qi(t.integerValue)===qi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=qi(t.doubleValue),r=qi(e.doubleValue);return n===r?Ki(n)===Ki(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return vi(t.arrayValue.values||[],e.arrayValue.values||[],Wi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ri(n)!==Ri(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Wi(n[i],r[i])))return!1;return!0}(t,e);default:return ci()}}function Ji(t,e){return void 0!==(t.values||[]).find((function(t){return Wi(t,e)}))}function Zi(t,e){var n,r,i,o,s=Xi(t),u=Xi(e);if(s!==u)return di(s,u);switch(s){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return r=e,i=qi((n=t).integerValue||n.doubleValue),o=qi(r.integerValue||r.doubleValue),i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1;case 3:return $i(t.timestampValue,e.timestampValue);case 4:return $i(Hi(t),Hi(e));case 5:return di(t.stringValue,e.stringValue);case 6:return function(t,e){var n=zi(t),r=zi(e);return n._(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=di(qi(t.latitude),qi(e.latitude));return 0!==n?n:di(qi(t.longitude),qi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Zi(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;var a=Zi(n[r[s]],i[o[s]]);if(0!==a)return a}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ci()}}function $i(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=Fi(t),r=Fi(e),i=di(n.seconds,r.seconds);return 0!==i?i:di(n.nanos,r.nanos)}function to(t){return eo(t)}function eo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(e=t.timestampValue,"time("+(n=Fi(e)).seconds+","+n.nanos+")"):"stringValue"in t?t.stringValue:"bytesValue"in t?zi(t.bytesValue).toBase64():"referenceValue"in t?(i=t.referenceValue,Li.ft(i).toString()):"geoPointValue"in t?"geo("+(r=t.geoPointValue).latitude+","+r.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=eo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+eo(t.fields[o])}return e+"}"}(t.mapValue):ci();var e,n,r,i}function no(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function ro(t){return!!t&&"integerValue"in t}function io(t){return!!t&&"arrayValue"in t}function oo(t){return!!t&&"nullValue"in t}function so(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function uo(t){return!!t&&"mapValue"in t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ao=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!uo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},t.prototype.isEqual=function(t){return Wi(this.proto,t.proto)},t}(),co=function(){function t(t){void 0===t&&(t=ao.empty()),this.It=t,this.At=new Map}return t.prototype.set=function(t,e){return this.Rt(t,e),this},t.prototype.delete=function(t){return this.Rt(t,null),this},t.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Xi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.tt(),e)},t.prototype.Pt=function(){var t=this.yt(Ci.ct(),this.At);return null!=t?new ao(t):this.It},t.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=uo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.yt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function ho(t){var e=[];return Vi(t.fields||{},(function(t,n){var r=new Ci([t]);if(uo(n)){var i=ho(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new Mi(e)}var fo=function(t,e){this.key=t,this.version=e},lo=function(t){function n(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).gt=r,o.Vt=!!i.Vt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return e(n,t),n.prototype.field=function(t){return this.gt.field(t)},n.prototype.data=function(){return this.gt},n.prototype.bt=function(){return this.gt.proto},n.prototype.isEqual=function(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},n.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),n}(fo),po=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return e(n,t),n.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(fo),vo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(n.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.isEqual=function(t){return t instanceof n&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},n}(fo),yo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function go(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new yo(t,e,n,r,i,o,s)}function mo(t){var e=fi(t);if(null===e.vt){var n=e.path.rt();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return(e=t).field.rt()+e.op.toString()+to(e.value);var e})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.rt()+e.dir;var e})).join(","),Yi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Po(e.startAt)),e.endAt&&(n+="|ub:",n+=Po(e.endAt)),e.vt=n}return e.vt}function bo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Co(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Wi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ro(t.startAt,e.startAt)&&Ro(t.endAt,e.endAt)}function wo(t){return Li.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Eo=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return e(n,t),n.create=function(t,e,r){return t.ut()?"in"===e||"not-in"===e?this.St(t,e,r):new _o(t,e,r):"array-contains"===e?new Ao(t,r):"in"===e?new So(t,r):"not-in"===e?new Do(t,r):"array-contains-any"===e?new Oo(t,r):new n(t,e,r)},n.St=function(t,e,n){return"in"===e?new Io(t,n):new To(t,n)},n.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Dt(Zi(e,this.value)):null!==e&&Xi(this.value)===Xi(e)&&this.Dt(Zi(e,this.value))},n.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ci()}},n.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},n}((function(){})),_o=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Li.ft(r.referenceValue),i}return e(n,t),n.prototype.matches=function(t){var e=Li.H(t.key,this.key);return this.Dt(e)},n}(Eo),Io=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=No("in",n),r}return e(n,t),n.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Eo),To=function(t){function n(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=No("not-in",n),r}return e(n,t),n.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},n}(Eo);function No(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Li.ft(t.referenceValue)}))}var Ao=function(t){function n(e,n){return t.call(this,e,"array-contains",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return io(e)&&Ji(e.arrayValue,this.value)},n}(Eo),So=function(t){function n(e,n){return t.call(this,e,"in",n)||this}return e(n,t),n.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ji(this.value.arrayValue,e)},n}(Eo),Do=function(t){function n(e,n){return t.call(this,e,"not-in",n)||this}return e(n,t),n.prototype.matches=function(t){if(Ji(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ji(this.value.arrayValue,e)},n}(Eo),Oo=function(t){function n(e,n){return t.call(this,e,"array-contains-any",n)||this}return e(n,t),n.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!io(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ji(e.value.arrayValue,t)}))},n}(Eo),xo=function(t,e){this.position=t,this.before=e};function Po(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return to(t)})).join(",")}var ko=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Co(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Lo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ut()?Li.H(Li.ft(s.referenceValue),n.key):Zi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ro(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Wi(t.position[n],e.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Uo(t,e,n,r,i,o,s,u){return new Vo(t,e,n,r,i,o,s,u)}function Mo(t){return new Vo(t)}function jo(t){return!Yi(t.limit)&&"F"===t.limitType}function Fo(t){return!Yi(t.limit)&&"L"===t.limitType}function qo(t){return t.xt.length>0?t.xt[0].field:null}function zo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Bo(t){return null!==t.collectionGroup}function Go(t){var e=fi(t);if(null===e.Nt){e.Nt=[];var n=zo(e),r=qo(e);if(null!==n&&null===r)n.ut()||e.Nt.push(new ko(n)),e.Nt.push(new ko(Ci.ht(),"asc"));else{for(var i=!1,o=0,s=e.xt;o<s.length;o++){var u=s[o];e.Nt.push(u),u.field.ut()&&(i=!0)}if(!i){var a=e.xt.length>0?e.xt[e.xt.length-1].dir:"asc";e.Nt.push(new ko(Ci.ht(),a))}}}return e.Nt}function Ho(t){var e=fi(t);if(!e.$t)if("F"===e.limitType)e.$t=go(e.path,e.collectionGroup,Go(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Go(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ko(o.field,s))}var u=e.endAt?new xo(e.endAt.position,!e.endAt.before):null,a=e.startAt?new xo(e.startAt.position,!e.startAt.before):null;e.$t=go(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.$t}function Yo(t,e,n){return new Vo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ko(t,e){return bo(Ho(t),Ho(e))&&t.limitType===e.limitType}function Qo(t){return mo(Ho(t))+"|lt:"+t.limitType}function Xo(t){return"Query(target="+(e=Ho(t),n=e.path.rt(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: ["+e.filters.map((function(t){return(e=t).field.rt()+" "+e.op+" "+to(e.value);var e})).join(", ")+"]"),Yi(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: ["+e.orderBy.map((function(t){return(e=t).field.rt()+" ("+e.dir+")";var e})).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Po(e.startAt)),e.endAt&&(n+=", endAt: "+Po(e.endAt)),"Target("+n+"); limitType=")+t.limitType+")";var e,n}function Wo(t,e){return n=t,i=(r=e).key.path,(null!==n.collectionGroup?r.key.dt(n.collectionGroup)&&n.path.nt(i):Li.wt(n.path)?n.path.isEqual(i):n.path.st(i))&&function(t,e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Lo(t.startAt,Go(t),e)||t.endAt&&Lo(t.endAt,Go(t),e))}(t,e);var n,r,i}function Jo(t){return function(e,n){for(var r=!1,i=0,o=Go(t);i<o.length;i++){var s=o[i],u=Zo(s,e,n);if(0!==u)return u;r=r||s.field.ut()}return 0}}function Zo(t,e,n){var r,i,o,s,u=t.field.ut()?Li.H(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Zi(o,s):ci());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return ci()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $o=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=gi.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.kt=function(e){return new t(this.target,this.targetId,this.Ft,e,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.Mt=function(e,n){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,e,this.resumeToken)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ki(e)?"-0":e}}function es(t){return{integerValue:""+t}}function ns(t,e){return Qi(e)?es(e):ts(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rs=function(){this.qt=void 0};function is(t,e,n){return t instanceof us?(i=e,o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(o.fields.__previous_value__=i),{mapValue:o}):t instanceof as?cs(t,e):t instanceof hs?fs(t,e):function(t,e){var n=ss(t,e),r=ps(n)+ps(t.Ut);return ro(n)&&ro(t.Ut)?es(r):ts(t.Qt,r)}(t,e);var r,i,o}function os(t,e,n){return t instanceof as?cs(t,e):t instanceof hs?fs(t,e):n}function ss(t,e){return t instanceof ls?ro(r=e)||(n=r)&&"doubleValue"in n?e:{integerValue:0}:null;var n,r}var us=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(rs),as=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(rs);function cs(t,e){for(var n=ds(e),r=function(t){n.some((function(e){return Wi(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var hs=function(t){function n(e){var n=this;return(n=t.call(this)||this).elements=e,n}return e(n,t),n}(rs);function fs(t,e){for(var n=ds(e),r=function(t){n=n.filter((function(e){return!Wi(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ls=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.Ut=n,r}return e(n,t),n}(rs);function ps(t){return qi(t.integerValue||t.doubleValue)}function ds(t){return io(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vs=function(t,e){this.field=t,this.transform=e},ys=function(t,e){this.version=t,this.transformResults=e},gs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Kt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ms(t,e){return void 0!==t.updateTime?e instanceof lo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof lo}var bs=function(){};function ws(t,e,n){return t instanceof Ns?(i=e,o=n,s=(r=t).value,u=Ds(r.fieldTransforms,i,o.transformResults),s=xs(r.fieldTransforms,s,u),new lo(r.key,o.version,s,{hasCommittedMutations:!0})):t instanceof As?function(t,e,n){if(!ms(t.jt,e))return new vo(t.key,n.version);var r=Ss(t,e,Ds(t.fieldTransforms,e,n.transformResults));return new lo(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new po(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n);var r,i,o,s,u}function Es(t,e,n){return t instanceof Ns?function(t,e,n){if(!ms(t.jt,e))return e;var r=t.value,i=Os(t.fieldTransforms,n,e);r=xs(t.fieldTransforms,r,i);var o=Ts(e);return new lo(t.key,o,r,{Vt:!0})}(t,e,n):t instanceof As?function(t,e,n){if(!ms(t.jt,e))return e;var r=Ts(e),i=Ss(t,e,Os(t.fieldTransforms,n,e));return new lo(t.key,r,i,{Vt:!0})}(t,e,n):(i=e,ms((r=t).jt,i)?new po(r.key,Oi.min()):i);var r,i}function _s(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof lo?e.field(o.field):void 0,u=ss(o.transform,s||null);null!=u&&(n=null==n?(new co).set(o.field,u):n.set(o.field,u))}return n?n.Pt():null}(t.fieldTransforms,e)}function Is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&vi(n,r,(function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof as&&o instanceof as||i instanceof hs&&o instanceof hs?vi(i.elements,o.elements,Wi):i instanceof ls&&o instanceof ls?Wi(i.Ut,o.Ut):i instanceof us&&o instanceof us);var n,r,i,o}))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt));var n,r}function Ts(t){return t instanceof lo?t.version:Oi.min()}var Ns=function(t){function n(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.jt=r,o.fieldTransforms=i,o.type=0,o}return e(n,t),n}(bs),As=function(t){function n(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.Gt=r,s.jt=i,s.fieldTransforms=o,s.type=1,s}return e(n,t),n}(bs);function Ss(t,e,n){var r,i,o,s;return i=t,o=r=e instanceof lo?e.data():ao.empty(),s=new co(o),i.Gt.fields.forEach((function(t){if(!t.et()){var e=i.data.field(t);null!==e?s.set(t,e):s.delete(t)}})),r=s.Pt(),xs(t.fieldTransforms,r,n)}function Ds(t,e,n){var r=[];hi(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof lo&&(u=e.field(o.field)),r.push(os(s,u,n[i]))}return r}function Os(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i],u=s.transform,a=null;n instanceof lo&&(a=n.field(s.field)),r.push(is(u,a,e))}return r}function xs(t,e,n){for(var r=new co(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}var Ps,ks,Cs=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=2,r.fieldTransforms=[],r}return e(n,t),n}(bs),Ls=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=3,r.fieldTransforms=[],r}return e(n,t),n}(bs),Rs=function(t){this.count=t};function Vs(t){switch(t){case mi.OK:return ci();case mi.CANCELLED:case mi.UNKNOWN:case mi.DEADLINE_EXCEEDED:case mi.RESOURCE_EXHAUSTED:case mi.INTERNAL:case mi.UNAVAILABLE:case mi.UNAUTHENTICATED:return!1;case mi.INVALID_ARGUMENT:case mi.NOT_FOUND:case mi.ALREADY_EXISTS:case mi.PERMISSION_DENIED:case mi.FAILED_PRECONDITION:case mi.ABORTED:case mi.OUT_OF_RANGE:case mi.UNIMPLEMENTED:case mi.DATA_LOSS:return!0;default:return ci()}}function Us(t){if(void 0===t)return si("GRPC error has no .code"),mi.UNKNOWN;switch(t){case Ps.OK:return mi.OK;case Ps.CANCELLED:return mi.CANCELLED;case Ps.UNKNOWN:return mi.UNKNOWN;case Ps.DEADLINE_EXCEEDED:return mi.DEADLINE_EXCEEDED;case Ps.RESOURCE_EXHAUSTED:return mi.RESOURCE_EXHAUSTED;case Ps.INTERNAL:return mi.INTERNAL;case Ps.UNAVAILABLE:return mi.UNAVAILABLE;case Ps.UNAUTHENTICATED:return mi.UNAUTHENTICATED;case Ps.INVALID_ARGUMENT:return mi.INVALID_ARGUMENT;case Ps.NOT_FOUND:return mi.NOT_FOUND;case Ps.ALREADY_EXISTS:return mi.ALREADY_EXISTS;case Ps.PERMISSION_DENIED:return mi.PERMISSION_DENIED;case Ps.FAILED_PRECONDITION:return mi.FAILED_PRECONDITION;case Ps.ABORTED:return mi.ABORTED;case Ps.OUT_OF_RANGE:return mi.OUT_OF_RANGE;case Ps.UNIMPLEMENTED:return mi.UNIMPLEMENTED;case Ps.DATA_LOSS:return mi.DATA_LOSS;default:return ci()}}(ks=Ps||(Ps={}))[ks.OK=0]="OK",ks[ks.CANCELLED=1]="CANCELLED",ks[ks.UNKNOWN=2]="UNKNOWN",ks[ks.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ks[ks.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ks[ks.NOT_FOUND=5]="NOT_FOUND",ks[ks.ALREADY_EXISTS=6]="ALREADY_EXISTS",ks[ks.PERMISSION_DENIED=7]="PERMISSION_DENIED",ks[ks.UNAUTHENTICATED=16]="UNAUTHENTICATED",ks[ks.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ks[ks.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ks[ks.ABORTED=10]="ABORTED",ks[ks.OUT_OF_RANGE=11]="OUT_OF_RANGE",ks[ks.UNIMPLEMENTED=12]="UNIMPLEMENTED",ks[ks.INTERNAL=13]="INTERNAL",ks[ks.UNAVAILABLE=14]="UNAVAILABLE",ks[ks.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ms=function(){function t(t,e){this.H=t,this.root=e||Fs.EMPTY}return t.prototype.zt=function(e,n){return new t(this.H,this.root.zt(e,n,this.H).copy(null,null,Fs.Ht,null,null))},t.prototype.remove=function(e){return new t(this.H,this.root.remove(e,this.H).copy(null,null,Fs.Ht,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.et=function(){return this.root.et()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Jt=function(){return this.root.Jt()},t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(t){return this.root.Xt(t)},t.prototype.forEach=function(t){this.Xt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Xt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.te=function(){return new js(this.root,null,this.H,!1)},t.prototype.ee=function(t){return new js(this.root,t,this.H,!1)},t.prototype.ne=function(){return new js(this.root,null,this.H,!0)},t.prototype.se=function(t){return new js(this.root,t,this.H,!0)},t}(),js=function(){function t(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return t.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},t.prototype.ce=function(){return this.re.length>0},t.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},t}(),Fs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.et=function(){return!1},t.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},t.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},t.prototype.min=function(){return this.left.et()?this:this.left.min()},t.prototype.Jt=function(){return this.min().key},t.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},t.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},t.prototype.he=function(){if(this.left.et())return t.EMPTY;var e=this;return e.left.le()||e.left.left.le()||(e=e._e()),(e=e.copy(null,null,null,e.left.he(),null)).ue()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),0===n(e,i.key)){if(i.right.et())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.ue()},t.prototype.le=function(){return this.color},t.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},t.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},t.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},t.prototype.we=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.fe=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},t.prototype.Ie=function(){if(this.le()&&this.left.le())throw ci();if(this.right.le())throw ci();var t=this.left.Ie();if(t!==this.right.Ie())throw ci();return t+(this.le()?0:1)},t}();Fs.EMPTY=null,Fs.RED=!0,Fs.Ht=!1,Fs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ci()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ci()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ci()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ci()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ci()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.zt=function(t,e,n){return new Fs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.et=function(){return!0},t.prototype.Xt=function(t){return!1},t.prototype.Zt=function(t){return!1},t.prototype.Jt=function(){return null},t.prototype.Yt=function(){return null},t.prototype.le=function(){return!1},t.prototype.Te=function(){return!0},t.prototype.Ie=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qs=function(){function t(t){this.H=t,this.data=new Ms(this.H)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Jt()},t.prototype.last=function(){return this.data.Yt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Xt((function(e,n){return t(e),!1}))},t.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(this.H(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ae=function(t,e){var n;for(n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},t.prototype.Re=function(t){var e=this.data.ee(t);return e.ce()?e.oe().key:null},t.prototype.te=function(){return new zs(this.data.te())},t.prototype.ee=function(t){return new zs(this.data.ee(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.et=function(){return this.data.et()},t.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.te(),r=e.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(0!==this.H(i,o))return!1}return!0},t.prototype.it=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.H);return n.data=e,n},t}(),zs=function(){function t(t){this.ye=t}return t.prototype.oe=function(){return this.ye.oe().key},t.prototype.ce=function(){return this.ye.ce()},t}(),Bs=new Ms(Li.H);function Gs(){return Bs}function Hs(){return Gs()}var Ys=new Ms(Li.H);function Ks(){return Ys}var Qs=new Ms(Li.H);var Xs=new qs(Li.H);function Ws(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Xs,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Js=new qs(di);function Zs(){return Js}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $s=function(){function t(t){this.H=t?function(e,n){return t(e,n)||Li.H(e.key,n.key)}:function(t,e){return Li.H(t.key,e.key)},this.ge=Ks(),this.Ve=new Ms(this.H)}return t.pe=function(e){return new t(e.H)},t.prototype.has=function(t){return null!=this.ge.get(t)},t.prototype.get=function(t){return this.ge.get(t)},t.prototype.first=function(){return this.Ve.Jt()},t.prototype.last=function(){return this.Ve.Yt()},t.prototype.et=function(){return this.Ve.et()},t.prototype.indexOf=function(t){var e=this.ge.get(t);return e?this.Ve.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ve.Xt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ve.te(),r=e.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.H=this.H,r.ge=e,r.Ve=n,r},t}(),tu=function(){function t(){this.be=new Ms(Li.H)}return t.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);n?0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):ci():this.be=this.be.zt(e,t)},t.prototype.ve=function(){var t=[];return this.be.Xt((function(e,n){t.push(n)})),t},t}(),eu=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}return t.Ne=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,$s.pe(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Ko(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),nu=function(){function t(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}return t.Me=function(e,n){var r=new Map;return r.set(e,ru.Le(e,n)),new t(Oi.min(),r,Zs(),Gs(),Ws())},t}(),ru=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}return t.Le=function(e,n){return new t(gi.T,n,Ws(),Ws(),Ws())},t}(),iu=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},ou=function(t,e){this.targetId=t,this.je=e},su=function(t,e,n,r){void 0===n&&(n=gi.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},uu=function(){function t(){this.Ge=0,this.ze=hu(),this.He=gi.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(t.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),t.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},t.prototype.en=function(){var t=Ws(),e=Ws(),n=Ws();return this.ze.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ci()}})),new ru(this.He,this.Je,t,e,n)},t.prototype.nn=function(){this.Ye=!1,this.ze=hu()},t.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},t.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},t.prototype.on=function(){this.Ge+=1},t.prototype.cn=function(){this.Ge-=1},t.prototype.an=function(){this.Ye=!0,this.Je=!0},t}(),au=function(){function t(t){this.un=t,this.hn=new Map,this.ln=Gs(),this._n=cu(),this.fn=new qs(di)}return t.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof lo?this.wn(r,t.We):t.We instanceof po&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},t.prototype.Tn=function(t){var e=this;this.In(t,(function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:ci()}}))},t.prototype.In=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.hn.forEach((function(t,r){n.An(r)&&e(r)}))},t.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,r=this.yn(e);if(r){var i=r.target;if(wo(i))if(0===n){var o=new Li(i.path);this.En(e,o,new po(o,Oi.min()))}else hi(1===n);else this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e))}},t.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach((function(r,i){var o=e.yn(i);if(o){if(r.Be&&wo(o.target)){var s=new Li(o.target.path);null!==e.ln.get(s)||e.pn(i,s)||e.En(i,s,new po(s,t))}r.Ze&&(n.set(i,r.en()),r.nn())}}));var r=Ws();this._n.forEach((function(t,n){var i=!0;n.Ae((function(t){var n=e.yn(t);return!n||2===n.Ft||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new nu(t,n,this.fn,this.ln,r);return this.ln=Gs(),this._n=cu(),this.fn=new qs(di),i},t.prototype.wn=function(t,e){if(this.An(t)){var n=this.pn(t,e.key)?2:0;this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t))}},t.prototype.En=function(t,e,n){if(this.An(t)){var r=this.mn(t);this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n))}},t.prototype.removeTarget=function(t){this.hn.delete(t)},t.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},t.prototype.on=function(t){this.mn(t).on()},t.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new uu,this.hn.set(t,e)),e},t.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new qs(di),this._n=this._n.zt(t,e)),e},t.prototype.An=function(t){var e=null!==this.yn(t);return e||oi("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},t.prototype.Rn=function(t){var e=this;this.hn.set(t,new uu),this.un.vn(t).forEach((function(n){e.En(t,n,null)}))},t.prototype.pn=function(t,e){return this.un.vn(t).has(e)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(){return new Ms(Li.H)}function hu(){return new Ms(Li.H)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fu={asc:"ASCENDING",desc:"DESCENDING"},lu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pu=function(t,e){this.t=t,this.Bt=e};function du(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function vu(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function yu(t,e){return du(t,e.j())}function gu(t){return hi(!!t),Oi.K((e=Fi(t),new Di(e.seconds,e.nanos)));var e}function mu(t,e){return(n=t,new Pi(["projects",n.projectId,"databases",n.database])).child("documents").child(e).rt();var n}function bu(t){var e=Pi.ot(t);return hi(zu(e)),e}function wu(t,e){return mu(t.t,e.path)}function Eu(t,e){var n=bu(e);if(n.get(1)!==t.t.projectId)throw new bi(mi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new bi(mi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Li(Nu(n))}function _u(t,e){return mu(t.t,e)}function Iu(t){var e=bu(t);return 4===e.length?Pi.ct():Nu(e)}function Tu(t){return new Pi(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Nu(t){return hi(t.length>4&&"documents"===t.get(4)),t.Y(5)}function Au(t,e,n){return{name:wu(t,e),fields:n.proto.mapValue.fields}}function Su(t,e){var n,r,i;if(e instanceof Ns)n={update:Au(t,e.key,e.value)};else if(e instanceof Cs)n={delete:wu(t,e.key)};else if(e instanceof As)n={update:Au(t,e.key,e.data),updateMask:qu(e.Gt)};else{if(!(e instanceof Ls))return ci();n={verify:wu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof us)return{fieldPath:e.field.rt(),setToServerValue:"REQUEST_TIME"};if(n instanceof as)return{fieldPath:e.field.rt(),appendMissingElements:{values:n.elements}};if(n instanceof hs)return{fieldPath:e.field.rt(),removeAllFromArray:{values:n.elements}};if(n instanceof ls)return{fieldPath:e.field.rt(),increment:n.Ut};throw ci()}(0,t)}))),e.jt.Wt||(n.currentDocument=(r=t,void 0!==(i=e.jt).updateTime?{updateTime:yu(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ci())),n}function Du(t,e){var n,r=e.currentDocument?void 0!==(n=e.currentDocument).updateTime?gs.updateTime(gu(n.updateTime)):void 0!==n.exists?gs.exists(n.exists):gs.Kt():gs.Kt(),i=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)hi("REQUEST_TIME"===e.setToServerValue),n=new us;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new as(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new hs(i)}else"increment"in e?n=new ls(t,e.increment):ci();var o=Ci.lt(e.fieldPath);return new vs(o,n)}(t,e)})):[];if(e.update){e.update.name;var o=Eu(t,e.update.name),s=new ao({mapValue:{fields:e.update.fields}});if(e.updateMask){var u=function(t){var e=t.fieldPaths||[];return new Mi(e.map((function(t){return Ci.lt(t)})))}(e.updateMask);return new As(o,s,u,r,i)}return new Ns(o,s,r,i)}if(e.delete){var a=Eu(t,e.delete);return new Cs(a,r)}if(e.verify){var c=Eu(t,e.verify);return new Ls(c,r)}return ci()}function Ou(t,e){return{documents:[_u(t,e.path)]}}function xu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=_u(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=_u(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(so(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NAN"}};if(oo(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(so(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NOT_NAN"}};if(oo(t.value))return{unaryFilter:{field:Uu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uu(t.field),op:Vu(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return{field:Uu((e=t).field),direction:Ru(e.dir)};var e}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u,a=(s=t,u=e.limit,s.Bt||Yi(u)?u:{value:u});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Cu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Cu(e.endAt)),n}function Pu(t){var e=Iu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){hi(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ku(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return new ko(Mu((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));var a,c,h=null;n.limit&&(a=n.limit,h=Yi(c="object"==typeof a?a.value:a)?null:c);var f=null;n.startAt&&(f=Lu(n.startAt));var l=null;return n.endAt&&(l=Lu(n.endAt)),Uo(e,i,u,s,h,"F",f,l)}function ku(t){return t?void 0!==t.unaryFilter?[Fu(t)]:void 0!==t.fieldFilter?[ju(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return ku(t)})).reduce((function(t,e){return t.concat(e)})):ci():[]}function Cu(t){return{before:t.before,values:t.position}}function Lu(t){var e=!!t.before,n=t.values||[];return new xo(n,e)}function Ru(t){return fu[t]}function Vu(t){return lu[t]}function Uu(t){return{fieldPath:t.rt()}}function Mu(t){return Ci.lt(t.fieldPath)}function ju(t){return Eo.create(Mu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ci()}}(t.fieldFilter.op),t.fieldFilter.value)}function Fu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Mu(t.unaryFilter.field);return Eo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Mu(t.unaryFilter.field);return Eo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Mu(t.unaryFilter.field);return Eo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Mu(t.unaryFilter.field);return Eo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ci()}}function qu(t){var e=[];return t.fields.forEach((function(t){return e.push(t.rt())})),{fieldPaths:e}}function zu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Gu=function(){function t(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t((function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)}),(function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Nn&&ci(),this.Nn=!0,this.xn?this.error?this.$n(n,this.error):this.Fn(e,this.result):new t((function(t,i){r.Dn=function(n){r.Fn(e,n).next(t,i)},r.Cn=function(e){r.$n(n,e).next(t,i)}}))},t.prototype.On=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.kn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.Fn=function(e,n){return e?this.kn((function(){return e(n)})):t.resolve(n)},t.prototype.$n=function(e,n){return e?this.kn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Mn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Ln=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Mn(r)},t}(),Hu=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new Bu,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new Qu(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){var r=$u(e.target.error);n.Bn.reject(new Qu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(o){throw new Qu(n,o)}},Object.defineProperty(t.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(oi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Wu(e)},t}(),Yu=function(){function t(e,n,r){this.name=e,this.version=n,this.Un=r,12.2===t.Qn(c())&&si("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return oi("SimpleDb","Removing database:",t),Ju(window.indexedDB.deleteDatabase(t)).On()},t.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=c(),n=t.Qn(e),r=0<n&&n<10,i=t.jn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},t.zn=function(t,e){return t.store(e)},t.Qn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.jn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Hn=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(oi("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Qu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new bi(mi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Qu(t,n))},i.onupgradeneeded=function(t){oi("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Un.Jn(e,i.transaction,t.oldVersion,n.version).next((function(){oi("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}}))}))},t.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,u,a,c;return i(this,(function(h){switch(h.label){case 0:r="readonly"===e,s=0,u=function(){var e,u,c,h,f;return i(this,(function(i){switch(i.label){case 0:++s,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,a.Hn(t)];case 2:return a.db=i.sent(),e=Hu.open(a.db,t,r?"readonly":"readwrite",n),u=o(e).catch((function(t){return e.abort(t),Gu.reject(t)})).On(),c={},u.catch((function(){})),[4,e.qn];case 3:return[2,(c.value=(i.sent(),u),c)];case 4:return h=i.sent(),f="FirebaseError"!==h.name&&s<3,oi("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,u()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Ku=function(){function t(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(t.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ts=!0},t.prototype.ss=function(t){this.es=t},t.prototype.delete=function(){return Ju(this.Zn.delete())},t}(),Qu=function(t){function n(e,n){var r=this;return(r=t.call(this,mi.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return e(n,t),n}(bi);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t){return"IndexedDbTransactionError"===t.name}var Wu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(oi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(oi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ju(n)},t.prototype.add=function(t){return oi("SimpleDb","ADD",this.store.name,t,t),Ju(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ju(this.store.get(t)).next((function(n){return void 0===n&&(n=null),oi("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return oi("SimpleDb","DELETE",this.store.name,t),Ju(this.store.delete(t))},t.prototype.count=function(){return oi("SimpleDb","COUNT",this.store.name),Ju(this.store.count())},t.prototype.rs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.os(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.cs=function(t,e){oi("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.us=!1;var r=this.cursor(n);return this.os(r,(function(t,e,n){return n.delete()}))},t.prototype.hs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.os(r,e)},t.prototype.ls=function(t){var e=this.cursor({});return new Gu((function(n,r){e.onerror=function(t){var e=$u(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.os=function(t,e){var n=[];return new Gu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ku(i),s=e(i.primaryKey,i.value,o);if(s instanceof Gu){var u=s.catch((function(t){return o.done(),Gu.reject(t)}));n.push(u)}o.xn?r():null===o.ns?i.continue():i.continue(o.ns)}else r()}})).next((function(){return Gu.Mn(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ju(t){return new Gu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=$u(t.target.error);n(e)}}))}var Zu=!1;function $u(t){var e=Yu.Qn(c());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new bi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Zu||(Zu=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ta=function(){function t(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new Bu,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch((function(t){}))}return t.Ts=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Is=setTimeout((function(){return e.As()}),t)},t.prototype.Rs=function(){return this.As()},t.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new bi(mi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.As=function(){var t=this;this._s.Ps((function(){return null!==t.Is?(t.clearTimeout(),t.op().then((function(e){return t.Es.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},t}();function ea(t,e){if(si("AsyncQueue",e+": "+t),Xu(t))return new bi(mi.UNAVAILABLE,e+": "+t);throw t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var na="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ra=function(){function t(){this.ys=[]}return t.prototype.gs=function(t){this.ys.push(t)},t.prototype.Vs=function(){this.ys.forEach((function(t){return t()}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ia(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=sa(e)),e=oa(t.get(n),e);return sa(e)}function oa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function sa(t){return t+""}function ua(t){var e=t.length;if(hi(e>=2),2===e)return hi(""===t.charAt(0)&&""===t.charAt(1)),Pi.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&ci(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:ci()}o=s+2}return new Pi(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aa=function(t,e){this.seconds=t,this.nanoseconds=e},ca=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ca.store="owner",ca.key="owner";var ha=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ha.store="mutationQueues",ha.keyPath="userId";var fa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};fa.store="mutations",fa.keyPath="batchId",fa.userMutationsIndex="userMutationsIndex",fa.userMutationsKeyPath=["userId","batchId"];var la=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ia(e)]},t.key=function(t,e,n){return[t,ia(e),n]},t}();la.store="documentMutations",la.PLACEHOLDER=new la;var pa=function(t,e){this.path=t,this.readTime=e},da=function(t,e){this.path=t,this.version=e},va=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};va.store="remoteDocuments",va.readTimeIndex="readTimeIndex",va.readTimeIndexPath="readTime",va.collectionReadTimeIndex="collectionReadTimeIndex",va.collectionReadTimeIndexPath=["parentPath","readTime"];var ya=function(t){this.byteSize=t};ya.store="remoteDocumentGlobal",ya.key="remoteDocumentGlobalKey";var ga=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ga.store="targets",ga.keyPath="targetId",ga.queryTargetsIndexName="queryTargetsIndex",ga.queryTargetsKeyPath=["canonicalId","targetId"];var ma=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ma.store="targetDocuments",ma.keyPath=["targetId","path"],ma.documentTargetsIndex="documentTargetsIndex",ma.documentTargetsKeyPath=["path","targetId"];var ba=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ba.key="targetGlobalKey",ba.store="targetGlobal";var wa=function(t,e){this.collectionId=t,this.parent=e};wa.store="collectionParents",wa.keyPath=["collectionId","parent"];var Ea=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ea.store="clientMetadata",Ea.keyPath="clientId";var _a=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};_a.store="bundles",_a.keyPath="bundleId";var Ia=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ia.store="namedQueries",Ia.keyPath="name";var Ta=s(s([],s(s([],s(s([],s(s([],[ha.store,fa.store,la.store,va.store,ga.store,ca.store,ba.store,ma.store]),[Ea.store])),[ya.store])),[wa.store])),[_a.store,Ia.store]),Na=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).ps=e,r.bs=n,r}return e(n,t),n}(ra);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(t,e){var n=fi(t);return Yu.zn(n.ps,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sa=function(){function t(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ss=function(t,e,n){for(var r=n.Ds,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ws(o,e,r[i]))}return e},t.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Es(s,e,this.vs));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Es(s,e,this.vs))}return e},t.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Ws())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&vi(this.mutations,t.mutations,(function(t,e){return Is(t,e)}))&&vi(this.baseMutations,t.baseMutations,(function(t,e){return Is(t,e)}))},t}(),Da=function(){function t(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}return t.from=function(e,n,r){hi(e.mutations.length===r.length);for(var i=Qs,o=e.mutations,s=0;s<o.length;s++)i=i.zt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Oa=function(t){this.Fs=t};function xa(t,e){if(e.document)return function(t,e,n){var r=Eu(t,e.name),i=gu(e.updateTime),o=new ao({mapValue:{fields:e.fields}});return new lo(r,i,o,{hasCommittedMutations:!!n})}(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Li.Et(e.noDocument.path),r=Ra(e.noDocument.readTime);return new po(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Li.Et(e.unknownDocument.path);return r=Ra(e.unknownDocument.version),new vo(i,r)}return ci()}function Pa(t,e,n){var r,i,o=ka(n),s=e.key.path.X().it();if(e instanceof lo){var u={name:wu(r=t.Fs,(i=e).key),fields:i.bt().mapValue.fields,updateTime:du(r,i.version.j())},a=e.hasCommittedMutations;return new va(null,null,u,a,o,s)}if(e instanceof po){var c=e.key.path.it(),h=La(e.version);return a=e.hasCommittedMutations,new va(null,new pa(c,h),null,a,o,s)}if(e instanceof vo){var f=e.key.path.it(),l=La(e.version);return new va(new da(f,l),null,null,!0,o,s)}return ci()}function ka(t){var e=t.j();return[e.seconds,e.nanoseconds]}function Ca(t){var e=new Di(t[0],t[1]);return Oi.K(e)}function La(t){var e=t.j();return new aa(e.seconds,e.nanoseconds)}function Ra(t){var e=new Di(t.seconds,t.nanoseconds);return Oi.K(e)}function Va(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Du(t.Fs,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Du(t.Fs,e)})),u=Di.fromMillis(e.localWriteTimeMs);return new Sa(e.batchId,u,n,s)}function Ua(t){var e,n,r=Ra(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ra(t.lastLimboFreeSnapshotVersion):Oi.min();return void 0!==t.query.documents?(hi(1===(n=t.query).documents.length),e=Ho(Mo(Iu(n.documents[0])))):e=Ho(Pu(t.query)),new $o(e,t.targetId,0,t.lastListenSequenceNumber,r,i,gi.fromBase64String(t.resumeToken))}function Ma(t,e){var n,r=La(e.Ot),i=La(e.lastLimboFreeSnapshotVersion);n=wo(e.target)?Ou(t.Fs,e.target):xu(t.Fs,e.target);var o=e.resumeToken.toBase64();return new ga(e.targetId,mo(e.target),r,o,e.sequenceNumber,i,n)}function ja(t){var e=Pu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Yo(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fa=function(){function t(){}return t.prototype.Os=function(t,e){return qa(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Ra(e.createTime),version:e.version};var e}))},t.prototype.ks=function(t,e){return qa(t).put({bundleId:(n=e).id,createTime:La(gu(n.createTime)),version:n.version});var n},t.prototype.Ms=function(t,e){return za(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:ja(e.bundledQuery),readTime:Ra(e.readTime)};var e}))},t.prototype.Ls=function(t,e){return za(t).put({name:(n=e).name,readTime:La(gu(n.readTime)),bundledQuery:n.bundledQuery});var n},t}();function qa(t){return Aa(t,_a.store)}function za(t){return Aa(t,Ia.store)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ba=function(){function t(){this.Bs=new Ga}return t.prototype.qs=function(t,e){return this.Bs.add(e),Gu.resolve()},t.prototype.Us=function(t,e){return Gu.resolve(this.Bs.getEntries(e))},t}(),Ga=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new qs(Pi.H),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.tt(),n=t.X(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new qs(Pi.H)).it()},t}(),Ha=function(){function t(){this.Qs=new Ga}return t.prototype.qs=function(t,e){var n=this;if(!this.Qs.has(e)){var r=e.tt(),i=e.X();t.gs((function(){n.Qs.add(e)}));var o={collectionId:r,parent:ia(i)};return Ya(t).put(o)}return Gu.resolve()},t.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[yi(e),""],!1,!0);return Ya(t).rs(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ua(o.parent))}return n}))},t}();function Ya(t){return Aa(t,wa.store)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ka={Ks:!1,Ws:0,js:0,Gs:0},Qa=function(){function t(t,e,n){this.zs=t,this.Hs=e,this.Js=n}return t.Ys=function(e){return new t(e,t.Xs,t.Zs)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(t.code!==mi.FAILED_PRECONDITION||t.message!==na)throw t;return oi("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qa.Xs=10,Qa.Zs=1e3,Qa.ti=new Qa(41943040,Qa.Xs,Qa.Zs),Qa.ei=new Qa(-1,0,0);var Wa=function(){function t(t,e){this.ni=t,this.si=e,this.ii={}}return t.prototype.get=function(t){var e=this.ni(t),n=this.ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.si(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Vi(this.ii,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.et=function(){return Ui(this.ii)},t}(),Ja=function(){function t(){this.ri=new Wa((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.oi=!1}return t.prototype.ci=function(t){var e=this.ri.get(t);return e?e.readTime:Oi.min()},t.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},t.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},t.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?Gu.resolve(n.hi):this.fi(t,e)},t.prototype.getEntries=function(t,e){return this.di(t,e)},t.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},t.prototype.ui=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t,e,n){var r=t.store(fa.store),i=t.store(la.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.hs({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){hi(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=la.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Gu.Mn(o).next((function(){return c}))}function $a(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ci();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tc=function(){function t(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}return t.mi=function(e,n,r,i){return hi(""!==e.uid),new t(e.m()?e.uid:"",n,r,i)},t.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return nc(t).hs({index:fa.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Ri=function(t,e,n,r){var i=this,o=rc(t),s=nc(t);return s.add({}).next((function(u){hi("number"==typeof u);for(var a=new Sa(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Su(t.Fs,e)})),i=n.mutations.map((function(e){return Su(t.Fs,e)}));return new fa(e,n.batchId,n.vs.toMillis(),r,i)}(i.Qt,i.userId,a),h=[],f=new qs((function(t,e){return di(t.rt(),e.rt())})),l=0,p=r;l<p.length;l++){var d=p[l],v=la.key(i.userId,d.key.path,u);f=f.add(d.key.path.X()),h.push(s.put(c)),h.push(o.put(v,la.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Ei.qs(t,e))})),t.gs((function(){i.Ii[u]=a.keys()})),Gu.Mn(h).next((function(){return a}))}))},t.prototype.Pi=function(t,e){var n=this;return nc(t).get(e).next((function(t){return t?(hi(t.userId===n.userId),Va(n.Qt,t)):null}))},t.prototype.yi=function(t,e){var n=this;return this.Ii[e]?Gu.resolve(this.Ii[e]):this.Pi(t,e).next((function(t){if(t){var r=t.keys();return n.Ii[e]=r,r}return null}))},t.prototype.gi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return nc(t).hs({index:fa.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(hi(e.batchId>=r),o=Va(n.Qt,e)),i.done()})).next((function(){return o}))},t.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return nc(t).hs({index:fa.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return nc(t).rs(fa.userMutationsIndex,n).next((function(t){return t.map((function(t){return Va(e.Qt,t)}))}))},t.prototype.bi=function(t,e){var n=this,r=la.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return rc(t).hs({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=ua(a);if(u===n.userId&&e.path.isEqual(h))return nc(t).get(c).next((function(t){if(!t)throw ci();hi(t.userId===n.userId),o.push(Va(n.Qt,t))}));s.done()})).next((function(){return o}))},t.prototype.vi=function(t,e){var n=this,r=new qs(di),i=[];return e.forEach((function(e){var o=la.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=rc(t).hs({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=ua(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),Gu.Mn(i).next((function(){return n.Si(t,r)}))},t.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=la.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new qs(di);return rc(t).hs({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=ua(a);s===n.userId&&r.nt(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Si(t,u)}))},t.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(nc(t).get(e).next((function(t){if(null===t)throw ci();hi(t.userId===n.userId),r.push(Va(n.Qt,t))})))})),Gu.Mn(i).next((function(){return r}))},t.prototype.Ci=function(t,e){var n=this;return Za(t.ps,this.userId,e).next((function(r){return t.gs((function(){n.xi(e.batchId)})),Gu.forEach(r,(function(e){return n.Ti.Ni(t,e)}))}))},t.prototype.xi=function(t){delete this.Ii[t]},t.prototype.$i=function(t){var e=this;return this.Ai(t).next((function(n){if(!n)return Gu.resolve();var r=IDBKeyRange.lowerBound(la.prefixForUser(e.userId)),i=[];return rc(t).hs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ua(t[1]);i.push(o)}else r.done()})).next((function(){hi(0===i.length)}))}))},t.prototype.Fi=function(t,e){return ec(t,this.userId,e)},t.prototype.Oi=function(t){var e=this;return ic(t).get(this.userId).next((function(t){return t||new ha(e.userId,-1,"")}))},t}();function ec(t,e,n){var r=la.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return rc(t).hs({range:o,us:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function nc(t){return Aa(t,fa.store)}function rc(t){return Aa(t,la.store)}function ic(t){return Aa(t,ha.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oc=function(){function t(t){this.ki=t}return t.prototype.next=function(){return this.ki+=2,this.ki},t.Mi=function(){return new t(0)},t.Li=function(){return new t(-1)},t}(),sc=function(){function t(t,e){this.Ti=t,this.Qt=e}return t.prototype.Bi=function(t){var e=this;return this.qi(t).next((function(n){var r=new oc(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Qi=function(t){return this.qi(t).next((function(t){return Oi.K(new Di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ki=function(t){return this.qi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)}))},t.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next((function(){return n.qi(t).next((function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)}))}))},t.prototype.Hi=function(t,e){return this.Gi(t,e)},t.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next((function(){return uc(t).delete(e.targetId)})).next((function(){return n.qi(t)})).next((function(e){return hi(e.targetCount>0),e.targetCount-=1,n.Ui(t,e)}))},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return uc(t).hs((function(s,u){var a=Ua(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Ji(t,a)))})).next((function(){return Gu.Mn(o)})).next((function(){return i}))},t.prototype.In=function(t,e){return uc(t).hs((function(t,n){var r=Ua(n);e(r)}))},t.prototype.qi=function(t){return ac(t).get(ba.key).next((function(t){return hi(null!==t),t}))},t.prototype.Ui=function(t,e){return ac(t).put(ba.key,e)},t.prototype.Gi=function(t,e){return uc(t).put(Ma(this.Qt,e))},t.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Zi=function(t){return this.qi(t).next((function(t){return t.targetCount}))},t.prototype.tr=function(t,e){var n=mo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return uc(t).hs({range:r,index:ga.queryTargetsIndexName},(function(t,n,r){var o=Ua(n);bo(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.er=function(t,e,n){var r=this,i=[],o=cc(t);return e.forEach((function(e){var s=ia(e.path);i.push(o.put(new ma(n,s))),i.push(r.Ti.nr(t,n,e))})),Gu.Mn(i)},t.prototype.sr=function(t,e,n){var r=this,i=cc(t);return Gu.forEach(e,(function(e){var o=ia(e.path);return Gu.Mn([i.delete([n,o]),r.Ti.ir(t,n,e)])}))},t.prototype.Yi=function(t,e){var n=cc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.rr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=cc(t),i=Ws();return r.hs({range:n,us:!0},(function(t,e,n){var r=ua(t[1]),o=new Li(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Fi=function(t,e){var n=ia(e.path),r=IDBKeyRange.bound([n],[yi(n)],!1,!0),i=0;return cc(t).hs({index:ma.documentTargetsIndex,us:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Sn=function(t,e){return uc(t).get(e).next((function(t){return t?Ua(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t){return Aa(t,ga.store)}function ac(t){return Aa(t,ba.store)}function cc(t){return Aa(t,ma.store)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=di(n,i);return 0===s?di(r,o):s}var fc=function(){function t(t){this.cr=t,this.buffer=new qs(hc),this.ar=0}return t.prototype.ur=function(){return++this.ar},t.prototype.hr=function(t){var e=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();hc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),lc=function(){function t(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}return t.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},t.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(t.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),t.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;oi("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,(function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return Xu(e=n.sent())?(oi("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Xa(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),pc=function(){function t(t,e){this.mr=t,this.params=e}return t.prototype.Ar=function(t,e){return this.mr.Rr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Pr=function(t,e){var n=this;if(0===e)return Gu.resolve(Si.q);var r=new fc(e);return this.mr.In(t,(function(t){return r.hr(t.sequenceNumber)})).next((function(){return n.mr.yr(t,(function(t){return r.hr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},t.prototype.gr=function(t,e){return this.mr.gr(t,e)},t.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(oi("LruGarbageCollector","Garbage collection skipped; disabled"),Gu.resolve(Ka)):this.pr(t).next((function(r){return r<n.params.zs?(oi("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),Ka):n.br(t,e)}))},t.prototype.pr=function(t){return this.mr.pr(t)},t.prototype.br=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.Ar(t,this.params.Hs).next((function(e){return e>c.params.Js?(oi("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Js+" from "+e),r=c.params.Js):r=e,o=Date.now(),c.Pr(t,r)})).next((function(r){return n=r,s=Date.now(),c.Xi(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.gr(t,n)})).next((function(t){return a=Date.now(),ii()<=T.DEBUG&&oi("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),Gu.resolve({Ks:!0,Ws:r,js:i,Gs:t})}))},t}(),dc=function(){function t(t,e){this.db=t,this.lr=new pc(this,e)}return t.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.vr=function(t){var e=0;return this.yr(t,(function(t){e++})).next((function(){return e}))},t.prototype.In=function(t,e){return this.db.Sr().In(t,e)},t.prototype.yr=function(t,e){return this.Dr(t,(function(t,n){return e(n)}))},t.prototype.nr=function(t,e,n){return vc(t,n)},t.prototype.ir=function(t,e,n){return vc(t,n)},t.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},t.prototype.Ni=function(t,e){return vc(t,e)},t.prototype.Cr=function(t,e){return r=e,i=!1,ic(n=t).ls((function(t){return ec(n,t,r).next((function(t){return t&&(i=!0),Gu.resolve(!t)}))})).next((function(){return i}));var n,r,i},t.prototype.gr=function(t,e){var n=this,r=this.db.$r().Nr(),i=[],o=0;return this.Dr(t,(function(s,u){if(u<=e){var a=n.Cr(t,s).next((function(e){if(!e)return o++,r._i(t,s).next((function(){return r.li(s),cc(t).delete([0,ia(s.path)])}))}));i.push(a)}})).next((function(){return Gu.Mn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.kt(t.bs);return this.db.Sr().Hi(t,n)},t.prototype.Fr=function(t,e){return vc(t,e)},t.prototype.Dr=function(t,e){var n,r=cc(t),i=Si.q;return r.hs({index:ma.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Si.q&&e(new Li(ua(n)),i),i=u,n=s):i=Si.q})).next((function(){i!==Si.q&&e(new Li(ua(n)),i)}))},t.prototype.pr=function(t){return this.db.$r().Or(t)},t}();function vc(t,e){return cc(t).put((n=e,r=t.bs,new ma(0,ia(n.path),r)));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yc=function(){function t(t,e){this.Qt=t,this.Ei=e}return t.prototype.ai=function(t,e,n){return bc(t).put(wc(e),n)},t.prototype.li=function(t,e){var n=bc(t),r=wc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.kr(t,r)}))},t.prototype._i=function(t,e){var n=this;return bc(t).get(wc(e)).next((function(t){return n.Mr(t)}))},t.prototype.Lr=function(t,e){var n=this;return bc(t).get(wc(e)).next((function(t){var e=n.Mr(t);return e?{hi:e,size:$a(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Hs();return this.Br(t,e,(function(t,e){var i=n.Mr(e);r=r.zt(t,i)})).next((function(){return r}))},t.prototype.qr=function(t,e){var n=this,r=Hs(),i=new Ms(Li.H);return this.Br(t,e,(function(t,e){var o=n.Mr(e);o?(r=r.zt(t,o),i=i.zt(t,$a(e))):(r=r.zt(t,null),i=i.zt(t,0))})).next((function(){return{Ur:r,Qr:i}}))},t.prototype.Br=function(t,e,n){if(e.et())return Gu.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return bc(t).hs({range:r},(function(t,e,r){for(var s=Li.Et(t);o&&Li.H(o,s)<0;)n(o,null),o=i.oe();o&&o.isEqual(s)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ce()?i.oe():null}))},t.prototype.Kr=function(t,e,n){var r=this,i=Ks(),o=e.path.length+1,s={};if(n.isEqual(Oi.min())){var u=e.path.it();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.it(),c=ka(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=va.collectionReadTimeIndex}return bc(t).hs(s,(function(t,n,s){if(t.length===o){var u=xa(r.Qt,n);e.path.nt(u.key.path)?u instanceof lo&&Wo(e,u)&&(i=i.zt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Nr=function(t){return new gc(this,!!t&&t.Wr)},t.prototype.Or=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return mc(t).get(ya.key).next((function(t){return hi(!!t),t}))},t.prototype.kr=function(t,e){return mc(t).put(ya.key,e)},t.prototype.Mr=function(t){if(t){var e=xa(this.Qt,t);return e instanceof po&&e.version.isEqual(Oi.min())?null:e}return null},t}(),gc=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).jr=e,r.Wr=n,r.Gr=new Wa((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return e(n,t),n.prototype.wi=function(t){var e=this,n=[],r=0,i=new qs((function(t,e){return di(t.rt(),e.rt())}));return this.ri.forEach((function(o,s){var u=e.Gr.get(o);if(s.hi){var a=Pa(e.jr.Qt,s.hi,e.ci(o));i=i.add(o.path.X());var c=$a(a);r+=c-u,n.push(e.jr.ai(t,o,a))}else if(r-=u,e.Wr){var h=Pa(e.jr.Qt,new po(o,Oi.min()),e.ci(o));n.push(e.jr.ai(t,o,h))}else n.push(e.jr.li(t,o))})),i.forEach((function(r){n.push(e.jr.Ei.qs(t,r))})),n.push(this.jr.updateMetadata(t,r)),Gu.Mn(n)},n.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next((function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)}))},n.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next((function(t){var e=t.Ur;return t.Qr.forEach((function(t,e){n.Gr.set(t,e)})),e}))},n}(Ja);function mc(t){return Aa(t,ya.store)}function bc(t){return Aa(t,va.store)}function wc(t){return t.path.it()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ec=function(){function t(t){this.Qt=t}return t.prototype.Jn=function(t,e,n,r){var i=this;hi(n<r&&n>=0&&r<=11);var o=new Hu("createOrUpgrade",e);n<1&&r>=1&&(t.createObjectStore(ca.store),function(t){t.createObjectStore(ha.store,{keyPath:ha.keyPath}),t.createObjectStore(fa.store,{keyPath:fa.keyPath,autoIncrement:!0}).createIndex(fa.userMutationsIndex,fa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(la.store)}(t),_c(t),function(t){t.createObjectStore(va.store)}(t));var s=Gu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ma.store),t.deleteObjectStore(ga.store),t.deleteObjectStore(ba.store)}(t),_c(t)),s=s.next((function(){return function(t){var e=t.store(ba.store),n=new ba(0,0,Oi.min().j(),0);return e.put(ba.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(fa.store).rs().next((function(n){t.deleteObjectStore(fa.store),t.createObjectStore(fa.store,{keyPath:fa.keyPath,autoIncrement:!0}).createIndex(fa.userMutationsIndex,fa.userMutationsKeyPath,{unique:!0});var r=e.store(fa.store),i=n.map((function(t){return r.put(t)}));return Gu.Mn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ea.store,{keyPath:Ea.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.zr(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ya.store)}(t),i.Hr(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.Jr(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Yr(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(va.store);e.createIndex(va.readTimeIndex,va.readTimeIndexPath,{unique:!1}),e.createIndex(va.collectionReadTimeIndex,va.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Xr(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(_a.store,{keyPath:_a.keyPath})}(t),function(t){t.createObjectStore(Ia.store,{keyPath:Ia.keyPath})}(t)}))),s},t.prototype.Hr=function(t){var e=0;return t.store(va.store).hs((function(t,n){e+=$a(n)})).next((function(){var n=new ya(e);return t.store(ya.store).put(ya.key,n)}))},t.prototype.zr=function(t){var e=this,n=t.store(ha.store),r=t.store(fa.store);return n.rs().next((function(n){return Gu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(fa.userMutationsIndex,i).next((function(r){return Gu.forEach(r,(function(r){hi(r.userId===n.userId);var i=Va(e.Qt,r);return Za(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Jr=function(t){var e=t.store(ma.store),n=t.store(va.store);return t.store(ba.store).get(ba.key).next((function(t){var r=[];return n.hs((function(n,i){var o=new Pi(n),s=[0,ia(o)];r.push(e.get(s).next((function(n){return n?Gu.resolve():(r=o,e.put(new ma(0,ia(r),t.highestListenSequenceNumber)));var r})))})).next((function(){return Gu.Mn(r)}))}))},t.prototype.Yr=function(t,e){t.createObjectStore(wa.store,{keyPath:wa.keyPath});var n=e.store(wa.store),r=new Ga,i=function(t){if(r.add(t)){var e=t.tt(),i=t.X();return n.put({collectionId:e,parent:ia(i)})}};return e.store(va.store).hs({us:!0},(function(t,e){var n=new Pi(t);return i(n.X())})).next((function(){return e.store(la.store).hs({us:!0},(function(t,e){t[0];var n=t[1],r=(t[2],ua(n));return i(r.X())}))}))},t.prototype.Xr=function(t){var e=this,n=t.store(ga.store);return n.hs((function(t,r){var i=Ua(r),o=Ma(e.Qt,i);return n.put(o)}))},t}();function _c(t){t.createObjectStore(ma.store,{keyPath:ma.keyPath}).createIndex(ma.documentTargetsIndex,ma.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ga.store,{keyPath:ga.keyPath}).createIndex(ga.queryTargetsIndexName,ga.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ba.store)}var Ic="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Tc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=s,this.document=u,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!t.Kn())throw new bi(mi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");var f,l;this.Ti=new dc(this,i),this.ho=n+"main",this.Qt=new Oa(a),this.lo=new Yu(this.ho,11,new Ec(this.Qt)),this._o=new sc(this.Ti,this.Qt),this.Ei=new Ha,this.fo=(f=this.Qt,l=this.Ei,new yc(f,l)),this.wo=new Fa,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===h&&si("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.To().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new bi(mi.FAILED_PRECONDITION,Ic);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t._o.Ki(e)}))})).then((function(e){t.so=new Si(e,t.eo)})).then((function(){t.io=!0})).catch((function(e){return t.lo&&t.lo.close(),Promise.reject(e)}))},t.prototype.Ro=function(t){var e=this;return this.uo=function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){return this.Er?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Po=function(t){var e=this;this.lo.Xn((function(n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps((function(){return r(e,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Ac(e).put(new Ea(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Vo(e).next((function(e){e||(t.isPrimary=!1,t.Zr.po((function(){return t.uo(!1)})))}))})).next((function(){return t.bo(e)})).next((function(n){return t.isPrimary&&!n?t.vo(e).next((function(){return!1})):!!n&&t.So(e).next((function(){return!0}))}))})).catch((function(e){if(Xu(e))return oi("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return oi("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Zr.po((function(){return t.uo(e)})),t.isPrimary=e}))},t.prototype.Vo=function(t){var e=this;return Nc(t).get(ca.key).next((function(t){return Gu.resolve(e.Do(t))}))},t.prototype.Co=function(t){return Ac(t).delete(this.clientId)},t.prototype.xo=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o=this;return i(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Aa(t,Ea.store);return e.rs().next((function(t){var n=o.$o(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Gu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=i.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)r=n[e],this.Eo.removeItem(this.Fo(r.clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,(function(){return t.To().then((function(){return t.xo()})).then((function(){return t.Ao()}))}))},t.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bo=function(t){var e=this;return this.no?Gu.resolve(!0):Nc(t).get(ca.key).next((function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.Oo(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new bi(mi.FAILED_PRECONDITION,Ic);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ac(t).rs().next((function(t){return void 0===e.$o(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&oi("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.ko=function(){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[ca.store,Ea.store],(function(e){var n=new Na(e,Si.q);return t.vo(n).next((function(){return t.Co(n)}))}))];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}}))}))},t.prototype.$o=function(t,e){var n=this;return t.filter((function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)}))},t.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Ac(e).rs().next((function(e){return t.$o(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t){return tc.mi(t,this.Qt,this.Ei,this.Ti)},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Ko=function(){return this.Ei},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;oi("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.lo.runTransaction(t,o,Ta,(function(o){return i=new Na(o,r.so?r.so.next():Si.q),"readwrite-primary"===e?r.Vo(i).next((function(t){return!!t||r.bo(i)})).next((function(e){if(!e)throw si("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Zr.po((function(){return r.uo(!1)})),new bi(mi.FAILED_PRECONDITION,na);return n(i)})).next((function(t){return r.So(i).next((function(){return t}))})):r.jo(i).next((function(){return n(i)}))})).then((function(t){return i.Vs(),t}))},t.prototype.jo=function(t){var e=this;return Nc(t).get(ca.key).next((function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new bi(mi.FAILED_PRECONDITION,Ic)}))},t.prototype.So=function(t){var e=new ca(this.clientId,this.allowTabSynchronization,Date.now());return Nc(t).put(ca.key,e)},t.Kn=function(){return Yu.Kn()},t.prototype.vo=function(t){var e=this,n=Nc(t);return n.get(ca.key).next((function(t){return e.Do(t)?(oi("IndexedDbPersistence","Releasing primary lease."),n.delete(ca.key)):Gu.resolve()}))},t.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(si("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps((function(){return t.inForeground="visible"===t.document.visibilityState,t.To()}))},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},t.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps((function(){return e.ko()}))},this.window.addEventListener("unload",this.ro))},t.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},t.prototype.Oo=function(t){var e;try{var n=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return oi("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(r){return si("IndexedDbPersistence","Failed to get zombied client id.",r),!1}},t.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){si("Failed to set zombie client id.",t)}},t.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},t.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Nc(t){return Aa(t,ca.store)}function Ac(t){return Aa(t,Ea.store)}function Sc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Dc=function(){function t(t,e,n){this.fo=t,this.zo=e,this.Ei=n}return t.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next((function(r){return n.Jo(t,e,r)}))},t.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t}))},t.prototype.Yo=function(t,e,n){var r=Hs();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)})),r},t.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next((function(e){return n.Zo(t,e)}))},t.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next((function(r){var i=n.Yo(t,e,r),o=Gs();return i.forEach((function(t,e){e||(e=new po(t,Oi.min())),o=o.zt(t,e)})),o}))},t.prototype.Kr=function(t,e,n){return r=e,Li.wt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.tc(t,e.path):Bo(e)?this.ec(t,e,n):this.nc(t,e,n);var r},t.prototype.tc=function(t,e){return this.Ho(t,new Li(e)).next((function(t){var e=Ks();return t instanceof lo&&(e=e.zt(t.key,t)),e}))},t.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=Ks();return this.Ei.Us(t,i).next((function(s){return Gu.forEach(s,(function(s){var u,a,c=(u=e,a=s.child(i),new Vo(a,null,u.xt.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));return r.nc(t,c,n).next((function(t){t.forEach((function(t,e){o=o.zt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next((function(n){return r=n,o.zo.Di(t,e)})).next((function(e){return i=e,o.sc(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Es(a,r.get(c),o.vs);r=h instanceof lo?r.zt(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Wo(e,n)||(r=r.remove(t))})),r}))},t.prototype.sc=function(t,e,n){for(var r=Ws(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof As&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof lo&&(c=c.zt(t,e))})),c}))},t}(),Oc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}return t.oc=function(e,n){for(var r=Ws(),i=Ws(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),xc=function(){function t(){}return t.prototype.cc=function(t){this.ac=t},t.prototype.Kr=function(t,e,n,r){var i,o=this;return 0===(i=e).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.xt.length||1===i.xt.length&&i.xt[0].field.ut())||n.isEqual(Oi.min())?this.uc(t,e):this.ac.Xo(t,r).next((function(i){var s=o.hc(e,i);return(jo(e)||Fo(e))&&o.lc(e.limitType,s,r,n)?o.uc(t,e):(ii()<=T.DEBUG&&oi("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Xo(e)),o.ac.Kr(t,e,n).next((function(t){return s.forEach((function(e){t=t.zt(e.key,e)})),t})))}))},t.prototype.hc=function(t,e){var n=new qs(Jo(t));return e.forEach((function(e,r){r instanceof lo&&Wo(t,r)&&(n=n.add(r))})),n},t.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version._(r)>0)},t.prototype.uc=function(t,e){return ii()<=T.DEBUG&&oi("QueryEngine","Using full collection scan to execute query:",Xo(e)),this.ac.Kr(t,e,Oi.min())},t}(),Pc=function(){function t(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Ms(di),this.dc=new Wa((function(t){return mo(t)}),bo),this.wc=Oi.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new Dc(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return t.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Vr(n,e.fc)}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(t,e,n,r){return new Pc(t,e,n,r)}function Cc(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:return n=fi(t),r=n.zo,o=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var i;return n.zo.pi(t).next((function(s){return i=s,r=n.persistence.Qo(e),o=new Dc(n.Ec,r,n.persistence.Ko()),r.pi(t)})).next((function(e){for(var n=[],r=[],s=Ws(),u=0,a=i;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return o.Xo(t,s).next((function(t){return{Ic:t,mc:n,Ac:r}}))}))}))];case 1:return s=i.sent(),[2,(n.zo=r,n.Tc=o,n._c.cc(n.Tc),s)]}}))}))}function Lc(t,e){var n=fi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,o,s,u,a,c,h=e.batch.keys(),f=n.Ec.Nr({Wr:!0});return(r=n,i=t,o=e,s=f,u=o.batch,a=u.keys(),c=Gu.resolve(),a.forEach((function(t){c=c.next((function(){return s._i(i,t)})).next((function(e){var n=e,r=o.$s.get(t);hi(null!==r),(!n||n.version._(r)<0)&&(n=u.Ss(t,n,o))&&s.ai(n,o.Ns)}))})),c.next((function(){return r.zo.Ci(i,u)}))).next((function(){return f.apply(t)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,h)}))}))}function Rc(t){var e=fi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e._o.Qi(t)}))}function Vc(t,e){var n=fi(t),r=e.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var s=[];e.$e.forEach((function(e,o){var u,a,c,h=i.get(o);if(h){s.push(n._o.sr(t,e.Qe,o).next((function(){return n._o.er(t,e.qe,o)})));var f=e.resumeToken;if(f.l()>0){var l=h.Mt(f,r).kt(t.bs);i=i.zt(o,l),u=h,c=e,hi((a=l).resumeToken.l()>0),(0===u.resumeToken.l()||a.Ot.W()-u.Ot.W()>=3e8||c.qe.size+c.Ue.size+c.Qe.size>0)&&s.push(n._o.Hi(t,l))}}}));var u=Gs();if(e.Oe.forEach((function(r,i){e.ke.has(r)&&s.push(n.persistence.Ti.Fr(t,r))})),s.push(function(t,e,n,r,i){var o=Ws();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Gs();return n.forEach((function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof po&&s.version.isEqual(Oi.min())?(e.li(n,a),o=o.zt(n,s)):null==u||s.version._(u.version)>0||0===s.version._(u.version)&&u.hasPendingWrites?(e.ai(s,a),o=o.zt(n,s)):oi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)})),o}))}(t,o,e.Oe,r,void 0).next((function(t){u=t}))),!r.isEqual(Oi.min())){var a=n._o.Qi(t).next((function(e){return n._o.Wi(t,t.bs,r)}));s.push(a)}return Gu.Mn(s).next((function(){return o.apply(t)})).next((function(){return n.Tc.Zo(t,u)}))})).then((function(t){return n.fc=i,t}))}function Uc(t,e){var n=fi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.zo.gi(t,e)}))}function Mc(t,e){var n=fi(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n._o.tr(t,e).next((function(i){return i?(r=i,Gu.resolve(r)):n._o.Bi(t).next((function(i){return r=new $o(e,i,0,t.bs),n._o.ji(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.fc.get(t.targetId);return(null===r||t.Ot._(r.Ot)>0)&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t}))}function jc(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u;return i(this,(function(i){switch(i.label){case 0:r=fi(t),o=r.fc.get(e),s=n?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,(function(t){return r.persistence.Ti.removeTarget(t,o)}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!Xu(u=i.sent()))throw u;return oi("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(o.target),[2]}}))}))}function Fc(t,e,n){var r=fi(t),i=Oi.min(),o=Ws();return r.persistence.runTransaction("Execute query","readonly",(function(t){return(s=r,u=t,a=Ho(e),c=fi(s),h=c.dc.get(a),void 0!==h?Gu.resolve(c.fc.get(h)):c._o.tr(u,a)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r._c.Kr(t,e,n?i:Oi.min(),n?o:Ws())})).next((function(t){return{documents:t,Rc:o}}));var s,u,a,c,h}))}function qc(t,e){var n=fi(t),r=fi(n._o),i=n.fc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Sn(t,e).next((function(t){return t?t.target:null}))}))}function zc(t){var e=fi(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n=e.Ec,r=t,i=e.wc,o=fi(n),s=Gs(),u=ka(i),a=bc(r),c=IDBKeyRange.lowerBound(u,!0),a.hs({index:va.readTimeIndex,range:c},(function(t,e){var n=xa(o.Qt,e);s=s.zt(n.key,n),u=e.readTime})).next((function(){return{Go:s,readTime:Ca(u)}}));var n,r,i,o,s,u,a,c})).then((function(t){var n=t.Go,r=t.readTime;return e.wc=r,n}))}function Bc(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,(e=fi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e=bc(t),n=Oi.min(),e.hs({index:va.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Ca(e.readTime)),r.done()})).next((function(){return n}));var e,n})).then((function(t){e.wc=t}))]}))}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gc=function(){function t(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return t.prototype.Os=function(t,e){return Gu.resolve(this.Vc.get(e))},t.prototype.ks=function(t,e){var n;return this.Vc.set(e.id,{id:(n=e).id,version:n.version,createTime:gu(n.createTime)}),Gu.resolve()},t.prototype.Ms=function(t,e){return Gu.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){return this.bc.set(e.name,{name:(n=e).name,query:ja(n.bundledQuery),readTime:gu(n.readTime)}),Gu.resolve();var n},t}(),Hc=function(){function t(){this.vc=new qs(Yc.Sc),this.Dc=new qs(Yc.Cc)}return t.prototype.et=function(){return this.vc.et()},t.prototype.nr=function(t,e){var n=new Yc(t,e);this.vc=this.vc.add(n),this.Dc=this.Dc.add(n)},t.prototype.xc=function(t,e){var n=this;t.forEach((function(t){return n.nr(t,e)}))},t.prototype.ir=function(t,e){this.Nc(new Yc(t,e))},t.prototype.$c=function(t,e){var n=this;t.forEach((function(t){return n.ir(t,e)}))},t.prototype.Fc=function(t){var e=this,n=new Li(new Pi([])),r=new Yc(n,t),i=new Yc(n,t+1),o=[];return this.Dc.me([r,i],(function(t){e.Nc(t),o.push(t.key)})),o},t.prototype.Oc=function(){var t=this;this.vc.forEach((function(e){return t.Nc(e)}))},t.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},t.prototype.kc=function(t){var e=new Li(new Pi([])),n=new Yc(e,t),r=new Yc(e,t+1),i=Ws();return this.Dc.me([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Fi=function(t){var e=new Yc(t,0),n=this.vc.Re(e);return null!==n&&t.isEqual(n.key)},t}(),Yc=function(){function t(t,e){this.key=t,this.Mc=e}return t.Sc=function(t,e){return Li.H(t.key,e.key)||di(t.Mc,e.Mc)},t.Cc=function(t,e){return di(t.Mc,e.Mc)||Li.H(t.key,e.key)},t}(),Kc=function(){function t(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new qs(Yc.Sc)}return t.prototype.Ai=function(t){return Gu.resolve(0===this.zo.length)},t.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,this.zo.length>0&&this.zo[this.zo.length-1];var o=new Sa(i,e,n,r);this.zo.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Bc=this.Bc.add(new Yc(a.key,i)),this.Ei.qs(t,a.key.path.X())}return Gu.resolve(o)},t.prototype.Pi=function(t,e){return Gu.resolve(this.qc(e))},t.prototype.gi=function(t,e){var n=e+1,r=this.Uc(n),i=r<0?0:r;return Gu.resolve(this.zo.length>i?this.zo[i]:null)},t.prototype.Vi=function(){return Gu.resolve(0===this.zo.length?-1:this.Lc-1)},t.prototype.pi=function(t){return Gu.resolve(this.zo.slice())},t.prototype.bi=function(t,e){var n=this,r=new Yc(e,0),i=new Yc(e,Number.POSITIVE_INFINITY),o=[];return this.Bc.me([r,i],(function(t){var e=n.qc(t.Mc);o.push(e)})),Gu.resolve(o)},t.prototype.vi=function(t,e){var n=this,r=new qs(di);return e.forEach((function(t){var e=new Yc(t,0),i=new Yc(t,Number.POSITIVE_INFINITY);n.Bc.me([e,i],(function(t){r=r.add(t.Mc)}))})),Gu.resolve(this.Qc(r))},t.prototype.Di=function(t,e){var n=e.path,r=n.length+1,i=n;Li.wt(i)||(i=i.child(""));var o=new Yc(new Li(i),0),s=new qs(di);return this.Bc.Ae((function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(s=s.add(t.Mc)),!0)}),o),Gu.resolve(this.Qc(s))},t.prototype.Qc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.qc(t);null!==r&&n.push(r)})),n},t.prototype.Ci=function(t,e){var n=this;hi(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return Gu.forEach(e.mutations,(function(i){var o=new Yc(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)})).next((function(){n.Bc=r}))},t.prototype.xi=function(t){},t.prototype.Fi=function(t,e){var n=new Yc(e,0),r=this.Bc.Re(n);return Gu.resolve(e.isEqual(r&&r.key))},t.prototype.$i=function(t){return this.zo.length,Gu.resolve()},t.prototype.Kc=function(t,e){return this.Uc(t)},t.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},t.prototype.qc=function(t){var e=this.Uc(t);return e<0||e>=this.zo.length?null:this.zo[e]},t}(),Qc=function(){function t(t,e){this.Ei=t,this.Wc=e,this.docs=new Ms(Li.H),this.size=0}return t.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:s,readTime:n}),this.size+=s-o,this.Ei.qs(t,r.path.X())},t.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype._i=function(t,e){var n=this.docs.get(e);return Gu.resolve(n?n.hi:null)},t.prototype.getEntries=function(t,e){var n=this,r=Hs();return e.forEach((function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)})),Gu.resolve(r)},t.prototype.Kr=function(t,e,n){for(var r=Ks(),i=new Li(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.key,a=s.value,c=a.hi,h=a.readTime;if(!e.path.nt(u.path))break;h._(n)<=0||c instanceof lo&&Wo(e,c)&&(r=r.zt(c.key,c))}return Gu.resolve(r)},t.prototype.jc=function(t,e){return Gu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Nr=function(t){return new Xc(this)},t.prototype.Or=function(t){return Gu.resolve(this.size)},t}(),Xc=function(t){function n(e){var n=this;return(n=t.call(this)||this).jr=e,n}return e(n,t),n.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach((function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)})),Gu.Mn(n)},n.prototype.fi=function(t,e){return this.jr._i(t,e)},n.prototype.di=function(t,e){return this.jr.getEntries(t,e)},n}(Ja),Wc=function(){function t(t){this.persistence=t,this.Gc=new Wa((function(t){return mo(t)}),bo),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Hc,this.targetCount=0,this.Jc=oc.Mi()}return t.prototype.In=function(t,e){return this.Gc.forEach((function(t,n){return e(n)})),Gu.resolve()},t.prototype.Qi=function(t){return Gu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ki=function(t){return Gu.resolve(this.zc)},t.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),Gu.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),Gu.resolve()},t.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new oc(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},t.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,Gu.resolve()},t.prototype.Hi=function(t,e){return this.Gi(e),Gu.resolve()},t.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),this.targetCount-=1,Gu.resolve()},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gc.delete(s),o.push(r.Yi(t,u.targetId)),i++)})),Gu.Mn(o).next((function(){return i}))},t.prototype.Zi=function(t){return Gu.resolve(this.targetCount)},t.prototype.tr=function(t,e){var n=this.Gc.get(e)||null;return Gu.resolve(n)},t.prototype.er=function(t,e,n){return this.Hc.xc(e,n),Gu.resolve()},t.prototype.sr=function(t,e,n){this.Hc.$c(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach((function(e){i.push(r.Ni(t,e))})),Gu.Mn(i)},t.prototype.Yi=function(t,e){return this.Hc.Fc(e),Gu.resolve()},t.prototype.rr=function(t,e){var n=this.Hc.kc(e);return Gu.resolve(n)},t.prototype.Fi=function(t,e){return Gu.resolve(this.Hc.Fi(e))},t}(),Jc=function(){function t(t,e){var n,r=this;this.Yc={},this.so=new Si(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Wc(this),this.Ei=new Ba,this.fo=(n=this.Ei,new Qc(n,(function(t){return r.Ti.Xc(t)}))),this.Qt=new Oa(e),this.wo=new Gc(this.Qt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Po=function(){},t.prototype.yo=function(){},t.prototype.Ko=function(){return this.Ei},t.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new Kc(this.Ei,this.Ti),this.Yc[t.A()]=e),e},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;oi("MemoryPersistence","Starting transaction:",t);var i=new Zc(this.so.next());return this.Ti.Zc(),n(i).next((function(t){return r.Ti.ta(i).next((function(){return t}))})).On().then((function(t){return i.Vs(),t}))},t.prototype.ea=function(t,e){return Gu.Ln(Object.values(this.Yc).map((function(n){return function(){return n.Fi(t,e)}})))},t}(),Zc=function(t){function n(e){var n=this;return(n=t.call(this)||this).bs=e,n}return e(n,t),n}(ra),$c=function(){function t(t){this.persistence=t,this.na=new Hc,this.sa=null}return t.ia=function(e){return new t(e)},Object.defineProperty(t.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw ci()},enumerable:!1,configurable:!0}),t.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),Gu.resolve()},t.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),Gu.resolve()},t.prototype.Ni=function(t,e){return this.ra.add(e.toString()),Gu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach((function(t){return n.ra.add(t.toString())}));var r=this.persistence.Sr();return r.rr(t,e.targetId).next((function(t){t.forEach((function(t){return n.ra.add(t.toString())}))})).next((function(){return r.Ji(t,e)}))},t.prototype.Zc=function(){this.sa=new Set},t.prototype.ta=function(t){var e=this,n=this.persistence.$r().Nr();return Gu.forEach(this.ra,(function(r){var i=Li._t(r);return e.oa(t,i).next((function(t){t||n.li(i)}))})).next((function(){return e.sa=null,n.apply(t)}))},t.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next((function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())}))},t.prototype.Xc=function(t){return 0},t.prototype.oa=function(t,e){var n=this;return Gu.Ln([function(){return Gu.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t,e){return"firestore_clients_"+t+"_"+e}function eh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.m()&&(r+="_"+e.uid),r}function nh(t,e){return"firestore_targets_"+t+"_"+e}var rh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ca=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new bi(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(si("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ih=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ca=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new bi(i.error.code,i.error.message)),o?new t(e,i.state,r):(si("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),oh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ca=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Zs(),s=0;i&&s<r.activeTargetIds.length;++s)i=Qi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(si("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),sh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ca=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(si("SharedClientState","Failed to parse online state: "+e),null)},t}(),uh=function(){function t(){this.activeTargetIds=Zs()}return t.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ah=function(){function t(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new Ms(di),this.Er=!1,this.Ta=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=th(this.persistenceKey,this.la),this.ma="firestore_sequence_number_"+this.persistenceKey,this.Ea=this.Ea.zt(this.la,new uh),this.Aa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ya=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ga=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return t.Kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,o,s,u,a,c,h,f,l=this;return i(this,(function(i){switch(i.label){case 0:return[4,this._a.Uo()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.la&&(o=this.getItem(th(this.persistenceKey,r)))&&(s=oh.ca(r,o))&&(this.Ea=this.Ea.zt(s.clientId,s));for(this.Va(),(u=this.storage.getItem(this.ya))&&(a=this.pa(u))&&this.ba(a),c=0,h=this.Ta;c<h.length;c++)f=h[c],this.wa(f);return this.Ta=[],this.window.addEventListener("unload",(function(){return l.ko()})),this.Er=!0,[2]}}))}))},t.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},t.prototype.va=function(){return this.Sa(this.Ea)},t.prototype.Da=function(t){var e=!1;return this.Ea.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Ca=function(t){this.xa(t,"pending")},t.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},t.prototype.Fa=function(t){var e="not-current";if(this.Da(t)){var n=this.storage.getItem(nh(this.persistenceKey,t));if(n){var r=ih.ca(t,n);r&&(e=r.state)}}return this.Oa.ua(t),this.Va(),e},t.prototype.ka=function(t){this.Oa.ha(t),this.Va()},t.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},t.prototype.La=function(t){this.removeItem(nh(this.persistenceKey,t))},t.prototype.Ba=function(t,e,n){this.qa(t,e,n)},t.prototype.Ua=function(t,e,n){var r=this;e.forEach((function(t){r.$a(t)})),this.currentUser=t,n.forEach((function(t){r.Ca(t)}))},t.prototype.Qa=function(t){this.Ka(t)},t.prototype.Wa=function(){this.ja()},t.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return oi("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){oi("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){oi("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(oi("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ia)return void si("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po((function(){return r(e,void 0,void 0,(function(){var t,e,r,o,s,u;return i(this,(function(i){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(e=this.Ha(n.key,n.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(r=this.Ja(n.key,n.newValue)))return[2,this.Ya(r)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(o=this.Xa(n.key,n.newValue)))return[2,this.Za(o)]}else if(n.key===this.ya){if(null!==n.newValue&&(s=this.pa(n.newValue)))return[2,this.ba(s)]}else if(n.key===this.ma)(u=function(t){var e=Si.q;if(null!=t)try{var n=JSON.parse(t);hi("number"==typeof n),e=n}catch(r){si("SharedClientState","Failed to read sequence number from WebStorage",r)}return e}(n.newValue))!==Si.q&&this.k(u);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),t.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},t.prototype.xa=function(t,e,n){var r=new rh(this.currentUser,t,e,n),i=eh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.aa())},t.prototype.$a=function(t){var e=eh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ka=function(t){var e={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(e))},t.prototype.qa=function(t,e,n){var r=nh(this.persistenceKey,t),i=new ih(t,e,n);this.setItem(r,i.aa())},t.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},t.prototype.Ga=function(t){var e=this.Aa.exec(t);return e?e[1]:null},t.prototype.Ha=function(t,e){var n=this.Ga(t);return oh.ca(n,e)},t.prototype.Ja=function(t,e){var n=this.Ra.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return rh.ca(new Ei(i),r,e)},t.prototype.Xa=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return ih.ca(r,e)},t.prototype.pa=function(t){return sh.ca(t)},t.prototype.Ya=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(oi("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},t.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this._a.su(s,u).then((function(){n.Ea=r}))},t.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},t.prototype.Sa=function(t){var e=Zs();return t.forEach((function(t,n){e=e.Pe(n.activeTargetIds)})),e},t}(),ch=function(){function t(){this.iu=new uh,this.ru={},this.fa=null,this.k=null}return t.prototype.Ca=function(t){},t.prototype.Na=function(t,e,n){},t.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},t.prototype.Ba=function(t,e,n){this.ru[t]=e},t.prototype.ka=function(t){this.iu.ha(t)},t.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.La=function(t){delete this.ru[t]},t.prototype.va=function(){return this.iu.activeTargetIds},t.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.start=function(){return this.iu=new uh,Promise.resolve()},t.prototype.Ua=function(t,e,n){},t.prototype.Qa=function(t){},t.prototype.ko=function(){},t.prototype.B=function(t){},t.prototype.Wa=function(){},t}(),hh=function(){function t(){}return t.prototype.ou=function(t){},t.prototype.ko=function(){},t}(),fh=function(){function t(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return t.prototype.ou=function(t){this.lu.push(t)},t.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},t.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},t.prototype.au=function(){oi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},t.prototype.hu=function(){oi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},t.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),lh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ph=function(){function t(t){this.fu=t.fu,this.du=t.du}return t.prototype.wu=function(t){this.Eu=t},t.prototype.Tu=function(t){this.Iu=t},t.prototype.onMessage=function(t){this.mu=t},t.prototype.close=function(){this.du()},t.prototype.send=function(t){this.fu(t)},t.prototype.Au=function(){this.Eu()},t.prototype.Ru=function(t){this.Iu(t)},t.prototype.Pu=function(t){this.mu(t)},t}(),dh=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return e(n,t),n.prototype.Su=function(t,e,n,r){return new Promise((function(i,o){var s=new ti;s.listenOnce(Xr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Qr.NO_ERROR:var e=s.getResponseJson();oi("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Qr.TIMEOUT:oi("Connection",'RPC "'+t+'" timed out'),o(new bi(mi.DEADLINE_EXCEEDED,"Request time out"));break;case Qr.HTTP_ERROR:var n=s.getStatus();if(oi("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=(a=r.status,c=a.toLowerCase().replace(/_/g,"-"),Object.values(mi).indexOf(c)>=0?c:mi.UNKNOWN);o(new bi(u,r.message))}else o(new bi(mi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new bi(mi.UNAVAILABLE,"Connection failed."));break;default:ci()}}finally{oi("Connection",'RPC "'+t+'" completed.')}var a,c}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},n.prototype.Cu=function(t,e){var n,r,i=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=new Br,s=Ge(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(u.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(c())||"object"==typeof navigator&&"ReactNative"===navigator.product||c().indexOf("Electron/")>=0||((r=c()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)||c().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(u.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");oi("Connection","Creating WebChannel: "+a,u);var h=o.createWebChannel(a,u),f=!1,l=!1,p=new ph({fu:function(t){l?oi("Connection","Not sending because WebChannel is closed:",t):(f||(oi("Connection","Opening WebChannel transport."),h.open(),f=!0),oi("Connection","WebChannel sending:",t),h.send(t))},du:function(){return h.close()}}),d=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(e){setTimeout((function(){throw e}),0)}}))};return d(h,$r.EventType.OPEN,(function(){l||oi("Connection","WebChannel transport opened.")})),d(h,$r.EventType.CLOSE,(function(){l||(l=!0,oi("Connection","WebChannel transport closed"),p.Ru())})),d(h,$r.EventType.ERROR,(function(t){l||(l=!0,ui("Connection","WebChannel transport errored:",t),p.Ru(new bi(mi.UNAVAILABLE,"The operation could not be completed")))})),d(h,$r.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];hi(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){oi("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Ps[t];if(void 0!==e)return Us(e)}(o),u=i.message;void 0===s&&(s=mi.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),l=!0,p.Ru(new bi(s,u)),h.close()}else oi("Connection","WebChannel received:",n),p.Pu(n)}})),d(s,Wr.STAT_EVENT,(function(t){t.stat===Jr?oi("Connection","Detected buffering proxy"):t.stat===Zr&&oi("Connection","Detected no buffering proxy")})),setTimeout((function(){p.Au()}),0),p},n}(function(){function t(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);oi("RestConnection","Sending: ",i,n);var o={};return this.vu(o,r),this.Su(t,i,o,n).then((function(t){return oi("RestConnection","Received: ",t),t}),(function(e){throw ui("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},t.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.3.0",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},t.prototype.bu=function(t,e){var n=lh[t];return this.gu+"/v1/"+e+":"+n},t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(){return"undefined"!=typeof window?window:null}function yh(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){return new pu(t,!0)}var mh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}return t.prototype.reset=function(){this.Fu=0},t.prototype.Mu=function(){this.Fu=this.$u},t.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);i>0&&oi("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,(function(){return e.ku=Date.now(),t()})),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},t.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},t.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},t}(),bh=function(){function t(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new mh(t,e)}return t.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Hu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ju()},t.prototype.stop=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Yu=function(){this.state=0,this.Gu.reset()},t.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,(function(){return t.Zu()})))},t.prototype.th=function(t){this.eh(),this.stream.send(t)},t.prototype.Zu=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this.Hu()?[2,this.close(0)]:[2]}))}))},t.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},t.prototype.close=function(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===mi.RESOURCE_EXHAUSTED?(si(e.toString()),si("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):e&&e.code===mi.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.nh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then((function(e){t.Wu===n&&t.ih(e)}),(function(n){e((function(){var e=new bi(mi.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)}))}))},t.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu((function(){n((function(){return e.state=2,e.listener.wu()}))})),this.stream.Tu((function(t){n((function(){return e.rh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.rh=function(t){return oi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps((function(){return e.Wu===t?n():(oi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),wh=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Qt=i,s}return e(n,t),n.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},n.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){var n,r;if("targetChange"in e){e.targetChange;var i="NO_CHANGE"===(r=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:ci(),o=e.targetChange.targetIds||[],s=function(t,e){return t.Bt?(hi(void 0===e||"string"==typeof e),gi.fromBase64String(e||"")):(hi(void 0===e||e instanceof Uint8Array),gi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?mi.UNKNOWN:Us(t.code);return new bi(e,t.message||"")}(a);n=new su(i,o,s,u||null)}else if("documentChange"in e){e.documentChange,(i=e.documentChange).document,i.document.name,i.document.updateTime,o=Eu(t,i.document.name),s=gu(i.document.updateTime);var a=new ao({mapValue:{fields:i.document.fields}}),c=(u=new lo(o,s,a,{}),i.targetIds||[]),h=i.removedTargetIds||[];n=new iu(c,h,u.key,u)}else if("documentDelete"in e)e.documentDelete,(i=e.documentDelete).document,o=Eu(t,i.document),s=i.readTime?gu(i.readTime):Oi.min(),a=new po(o,s),u=i.removedTargetIds||[],n=new iu([],u,a.key,a);else if("documentRemove"in e)e.documentRemove,(i=e.documentRemove).document,o=Eu(t,i.document),s=i.removedTargetIds||[],n=new iu([],s,o,null);else{if(!("filter"in e))return ci();e.filter;var f=e.filter;f.targetId,i=f.count||0,o=new Rs(i),s=f.targetId,n=new ou(s,o)}return n}(this.Qt,t),n=function(t){if(!("targetChange"in t))return Oi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Oi.min():e.readTime?gu(e.readTime):Oi.min()}(t);return this.listener.ah(e,n)},n.prototype.uh=function(t){var e,n,r,i,o={};o.database=Tu(this.Qt),o.addTarget=(e=this.Qt,i=(n=t).target,(r=wo(i)?{documents:Ou(e,i)}:{query:xu(e,i)}).targetId=n.targetId,n.resumeToken.l()>0?r.resumeToken=vu(e,n.resumeToken):n.Ot._(Oi.min())>0&&(r.readTime=du(e,n.Ot.j())),r);var s=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ci()}}(0,e.Ft);return null==n?null:{"goog-listen-tags":n}}(this.Qt,t);s&&(o.labels=s),this.th(o)},n.prototype.hh=function(t){var e={};e.database=Tu(this.Qt),e.removeTarget=t,this.th(e)},n}(bh),Eh=function(t){function n(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Qt=i,s.lh=!1,s}return e(n,t),Object.defineProperty(n.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),n.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},n.prototype.nh=function(){this.lh&&this.fh([])},n.prototype.oh=function(t){return this.Qu.Cu("Write",t)},n.prototype.onMessage=function(t){if(hi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=(r=t.writeResults,i=t.commitTime,r&&r.length>0?(hi(void 0!==i),r.map((function(t){return n=i,(r=(e=t).updateTime?gu(e.updateTime):gu(n)).isEqual(Oi.min())&&(r=gu(n)),new ys(r,e.transformResults||[]);var e,n,r}))):[]),n=gu(t.commitTime);return this.listener.dh(n,e)}var r,i;return hi(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},n.prototype.Eh=function(){var t={};t.database=Tu(this.Qt),this.th(t)},n.prototype.fh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Su(e.Qt,t)}))};this.th(n)},n}(bh),_h=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qu=n,i.Qt=r,i.Th=!1,i}return e(n,t),n.prototype.Ih=function(){if(this.Th)throw new bi(mi.FAILED_PRECONDITION,"The client has already been terminated.")},n.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.pu(t,e,n,i)})).catch((function(t){throw t.code===mi.UNAUTHENTICATED&&r.credentials.p(),t}))},n.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.Du(t,e,n,i)})).catch((function(t){throw t.code===mi.UNAUTHENTICATED&&r.credentials.p(),t}))},n.prototype.terminate=function(){this.Th=!1},n}((function(){})),Ih=function(){function t(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return t.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,(function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()})))},t.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},t.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},t.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},t.prototype.gh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(si(e),this.Rh=!1):oi("OnlineStateTracker",e)},t.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},t}(),Th=function(t,e,n,o,s){var u=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=s,this.Fh.ou((function(t){n.Ps((function(){return r(u,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return Ch(this)?(oi("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=fi(t)).Nh.add(4),[4,Ah(e)];case 1:return n.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,Nh(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Oh=new Ih(n,o)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:if(!Ch(t))return[3,4];e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ah(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Sh(t,e){var n=fi(t);n.xh.has(e.targetId)||(n.xh.set(e.targetId,e),kh(n)?Ph(n):Qh(n).Hu()&&Oh(n,e))}function Dh(t,e){var n=fi(t),r=Qh(n);n.xh.delete(e),r.Hu()&&xh(n,e),0===n.xh.size&&(r.Hu()?r.Xu():Ch(n)&&n.Oh.set("Unknown"))}function Oh(t,e){t.kh.on(e.targetId),Qh(t).uh(e)}function xh(t,e){t.kh.on(e),Qh(t).hh(e)}function Ph(t){t.kh=new au({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),Qh(t).start(),t.Oh.Ph()}function kh(t){return Ch(t)&&!Qh(t).zu()&&t.xh.size>0}function Ch(t){return 0===fi(t).Nh.size}function Lh(t){t.kh=void 0}function Rh(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return t.xh.forEach((function(e,n){Oh(t,e)})),[2]}))}))}function Vh(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){return Lh(t),kh(t)?(t.Oh.Vh(e),Ph(t)):t.Oh.set("Unknown"),[2]}))}))}function Uh(t,e,n){return r(this,void 0,void 0,(function(){var o,s,u;return i(this,(function(a){switch(a.label){case 0:if(t.Oh.set("Online"),!(e instanceof su&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return i(this,(function(i){switch(i.label){case 0:n=e.cause,r=0,o=e.targetIds,i.label=1;case 1:return r<o.length?(s=o[r],t.xh.has(s)?[4,t.Dh.Mh(s,n)]:[3,3]):[3,5];case 2:i.sent(),t.xh.delete(s),t.kh.removeTarget(s),i.label=3;case 3:i.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return o=a.sent(),oi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),o),[4,Mh(t,o)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof iu?t.kh.dn(e):e instanceof ou?t.kh.Pn(e):t.kh.Tn(e),n.isEqual(Oi.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Rc(t.bh)];case 8:return s=a.sent(),n._(s)>=0?[4,(c=t,h=n,f=c.kh.Vn(h),f.$e.forEach((function(t,e){if(t.resumeToken.l()>0){var n=c.xh.get(e);n&&c.xh.set(e,n.Mt(t.resumeToken,h))}})),f.Fe.forEach((function(t){var e=c.xh.get(t);if(e){c.xh.set(t,e.Mt(gi.T,e.Ot)),xh(c,t);var n=new $o(e.target,t,1,e.sequenceNumber);Oh(c,n)}})),c.Dh.Lh(f))]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return oi("RemoteStore","Failed to raise snapshot:",u=a.sent()),[4,Mh(t,u)];case 12:return a.sent(),[3,13];case 13:return[2]}var c,h,f}))}))}function Mh(t,e,n){return r(this,void 0,void 0,(function(){var o=this;return i(this,(function(s){switch(s.label){case 0:if(!Xu(e))throw e;return t.Nh.add(1),[4,Ah(t)];case 1:return s.sent(),t.Oh.set("Offline"),n||(n=function(){return Rc(t.bh)}),t._s.po((function(){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return oi("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,Nh(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function jh(t,e){return e().catch((function(n){return Mh(t,n,e)}))}function Fh(t){return r(this,void 0,void 0,(function(){var e,n,r,o,s;return i(this,(function(i){switch(i.label){case 0:e=fi(t),n=Xh(e),r=e.Ch.length>0?e.Ch[e.Ch.length-1].batchId:-1,i.label=1;case 1:if(!(Ch(u=e)&&u.Ch.length<10))return[3,7];i.label=2;case 2:return i.trys.push([2,4,,6]),[4,Uc(e.bh,r)];case 3:return null===(o=i.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=o.batchId,function(t,e){t.Ch.push(e);var n=Xh(t);n.Hu()&&n._h&&n.fh(e.mutations)}(e,o),[3,6]);case 4:return s=i.sent(),[4,Mh(e,s)];case 5:return i.sent(),[3,6];case 6:return[3,1];case 7:return qh(e)&&zh(e),[2]}var u}))}))}function qh(t){return Ch(t)&&!Xh(t).zu()&&t.Ch.length>0}function zh(t){Xh(t).start()}function Bh(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return Xh(t).Eh(),[2]}))}))}function Gh(t){return r(this,void 0,void 0,(function(){var e,n,r,o;return i(this,(function(i){for(e=Xh(t),n=0,r=t.Ch;n<r.length;n++)o=r[n],e.fh(o.mutations);return[2]}))}))}function Hh(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=t.Ch.shift(),o=Da.from(r,e,n),[4,jh(t,(function(){return t.Dh.Bh(o)}))];case 1:return i.sent(),[4,Fh(t)];case 2:return i.sent(),[2]}}))}))}function Yh(t,e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e&&Xh(t)._h?[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return Vs(r=e.code)&&r!==mi.ABORTED?(n=t.Ch.shift(),Xh(t).Yu(),[4,jh(t,(function(){return t.Dh.qh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Fh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return qh(t)&&zh(t),[2]}}))}))}function Kh(t,e){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=fi(t),e?(n.Nh.delete(2),[4,Nh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,Ah(n)]);case 3:r.sent(),n.Oh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Qh(t){var e,n,o,s,u=this;return t.Uh||(t.Uh=(e=t.Sh,n=t._s,o={wu:Rh.bind(null,t),Tu:Vh.bind(null,t),ah:Uh.bind(null,t)},(s=fi(e)).Ih(),new wh(n,s.Qu,s.credentials,s.Qt,o)),t.$h.push((function(e){return r(u,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e?(t.Uh.Yu(),kh(t)?Ph(t):t.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:n.sent(),Lh(t),n.label=3;case 3:return[2]}}))}))}))),t.Uh}function Xh(t){var e,n,o,s,u=this;return t.Qh||(t.Qh=(e=t.Sh,n=t._s,o={wu:Bh.bind(null,t),Tu:Yh.bind(null,t),wh:Gh.bind(null,t),dh:Hh.bind(null,t)},(s=fi(e)).Ih(),new Eh(n,s.Qu,s.credentials,s.Qt,o)),t.$h.push((function(e){return r(u,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e?(t.Qh.Yu(),[4,Fh(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:n.sent(),t.Ch.length>0&&(oi("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),n.label=4;case 4:return[2]}}))}))}))),t.Qh}var Wh=function(){this.Kh=void 0,this.listeners=[]},Jh=function(){this.queries=new Wa((function(t){return Qo(t)}),Ko),this.onlineState="Unknown",this.Wh=new Set};function Zh(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c;return i(this,(function(i){switch(i.label){case 0:if(n=fi(t),r=e.query,o=!1,(s=n.queries.get(r))||(o=!0,s=new Wh),!o)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),u=s,[4,n.jh(r)];case 2:return u.Kh=i.sent(),[3,4];case 3:return a=i.sent(),c=ea(a,"Initialization of query '"+Xo(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,s),s.listeners.push(e),e.Gh(n.onlineState),s.Kh&&e.zh(s.Kh)&&nf(n),[2]}}))}))}function $h(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u;return i(this,(function(i){return n=fi(t),r=e.query,o=!1,(s=n.queries.get(r))&&(u=s.listeners.indexOf(e))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),o?[2,(n.queries.delete(r),n.Hh(r))]:[2]}))}))}function tf(t,e){for(var n=fi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].zh(s)&&(r=!0);a.Kh=s}}r&&nf(n)}function ef(t,e,n){var r=fi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function nf(t){t.Wh.forEach((function(t){t.next()}))}var rf=function(){function t(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new eu(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},t.prototype.onError=function(t){this.Jh.error(t)},t.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},t.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},t.prototype.Zh=function(t){if(t.docChanges.length>0)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.el=function(t){t=eu.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},t}(),of=function(t){this.key=t},sf=function(t){this.key=t},uf=function(){function t(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=Ws(),this.De=Ws(),this.hl=Jo(t),this.ll=new $s(this.hl)}return Object.defineProperty(t.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),t.prototype.fl=function(t,e){var n=this,r=e?e.dl:new tu,i=e?e.ll:this.ll,o=e?e.De:this.De,s=i,u=!1,a=jo(this.query)&&i.size===this.query.limit?i.last():null,c=Fo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt((function(t,e){var h=i.get(t),f=e instanceof lo?e:null;f&&(f=Wo(n.query,f)?f:null);var l=!!h&&n.De.has(h.key),p=!!f&&(f.Vt||n.De.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.wl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.hl(f,a)>0||c&&n.hl(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),jo(this.query)||Fo(this.query))for(;s.size>this.query.limit;){var h=jo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ll:s,dl:r,lc:u,De:o}},t.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},t.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort((function(t,e){return n=t.type,i=e.type,(o=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ci()}})(n)-o(i)||r.hl(t.doc,e.doc);var n,i,o})),this.El(n);var s=e?this.Tl():[],u=0===this.ul.size&&this.Be?1:0,a=u!==this.al;return this.al=u,0!==o.length||a?{snapshot:new eu(this.query,t.ll,i,o,t.De,0===u,a,!1),Il:s}:{Il:s}},t.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new tu,De:this.De,lc:!1},!1)):{Il:[]}},t.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},t.prototype.El=function(t){var e=this;t&&(t.qe.forEach((function(t){return e.cl=e.cl.add(t)})),t.Ue.forEach((function(t){})),t.Qe.forEach((function(t){return e.cl=e.cl.delete(t)})),this.Be=t.Be)},t.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=Ws(),this.ll.forEach((function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))}));var n=[];return e.forEach((function(e){t.ul.has(e)||n.push(new sf(e))})),this.ul.forEach((function(t){e.has(t)||n.push(new of(t))})),n},t.prototype.Al=function(t){this.cl=t.Rc,this.ul=Ws();var e=this.fl(t.documents);return this.wi(e,!0)},t.prototype.Rl=function(){return eu.Ne(this.query,this.ll,this.De,0===this.al)},t}(),af=function(t,e,n){this.query=t,this.targetId=e,this.view=n},cf=function(t){this.key=t,this.Pl=!1},hf=function(){function t(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Wa((function(t){return Qo(t)}),Ko),this.Sl=new Map,this.Dl=new Set,this.Cl=new Ms(Li.H),this.xl=new Map,this.Nl=new Hc,this.$l={},this.Fl=new Map,this.Ol=oc.Li(),this.onlineState="Unknown",this.kl=void 0}return Object.defineProperty(t.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a;return i(this,(function(i){switch(i.label){case 0:return n=Ff(t),(s=n.vl.get(e))?(r=s.targetId,n.Vl.Fa(r),o=s.view.Rl(),[3,4]):[3,1];case 1:return[4,Mc(n.bh,Ho(e))];case 2:return u=i.sent(),a=n.Vl.Fa(u.targetId),r=u.targetId,[4,lf(n,e,r,"current"===a)];case 3:o=i.sent(),n.Ml&&Sh(n.yl,u),i.label=4;case 4:return[2,o]}}))}))}function lf(t,e,n,o){return r(this,void 0,void 0,(function(){var s,u,a,c,h,f;return i(this,(function(l){switch(l.label){case 0:return t.Ll=function(e,n,o){return function(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,u;return i(this,(function(i){switch(i.label){case 0:return(r=e.view.fl(n)).lc?[4,Fc(t.bh,e.query,!1).then((function(t){var n=t.documents;return e.view.fl(n,r)}))]:[3,2];case 1:r=i.sent(),i.label=2;case 2:return s=o&&o.$e.get(e.targetId),u=e.view.wi(r,t.Ml,s),[2,(Nf(t,e.targetId,u.Il),u.snapshot)]}}))}))}(t,e,n,o)},[4,Fc(t.bh,e,!0)];case 1:return s=l.sent(),u=new uf(e,s.Rc),a=u.fl(s.documents),c=ru.Le(n,o&&"Offline"!==t.onlineState),h=u.wi(a,t.Ml,c),Nf(t,n,h.Il),f=new af(e,n,u),[2,(t.vl.set(e,f),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),h.snapshot)]}}))}))}function pf(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=fi(t),r=n.vl.get(e),(o=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,o.filter((function(t){return!Ko(t,e)}))),void n.vl.delete(e))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,jc(n.bh,r.targetId,!1).then((function(){n.Vl.La(r.targetId),Dh(n.yl,r.targetId),If(n,r.targetId)})).catch(Xa)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return If(n,r.targetId),[4,jc(n.bh,r.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))}function df(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u;return i(this,(function(i){switch(i.label){case 0:r=qf(t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,(a=r.bh,c=e,f=fi(a),l=Di.now(),p=c.reduce((function(t,e){return t.add(e.key)}),Ws()),f.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return f.Tc.Xo(t,p).next((function(e){h=e;for(var n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=_s(o,h.get(o.key));null!=s&&n.push(new As(o.key,s,ho(s.proto.mapValue),gs.exists(!0)))}return f.zo.Ri(t,l,n,c)}))})).then((function(t){var e=t.xs(h);return{batchId:t.batchId,ri:e}})))];case 2:return o=i.sent(),r.Vl.Ca(o.batchId),function(t,e,n){var r=t.$l[t.currentUser.A()];r||(r=new Ms(di)),r=r.zt(e,n),t.$l[t.currentUser.A()]=r}(r,o.batchId,n),[4,Df(r,o.ri)];case 3:return i.sent(),[4,Fh(r.yl)];case 4:return i.sent(),[3,6];case 5:return s=i.sent(),u=ea(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}var a,c,h,f,l,p}))}))}function vf(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:n=fi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Vc(n.bh,e)];case 2:return r=i.sent(),e.$e.forEach((function(t,e){var r=n.xl.get(e);r&&(hi(t.qe.size+t.Ue.size+t.Qe.size<=1),t.qe.size>0?r.Pl=!0:t.Ue.size>0?hi(r.Pl):t.Qe.size>0&&(hi(r.Pl),r.Pl=!1))})),[4,Df(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Xa(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function yf(t,e,n){var r=fi(t);if(r.Ml&&0===n||!r.Ml&&1===n){var i=[];r.vl.forEach((function(t,n){var r=n.view.Gh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=fi(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Gh(e)&&(r=!0)})),r&&nf(n)}(r.gl,e),i.length&&r.bl.ah(i),r.onlineState=e,r.Ml&&r.Vl.Qa(e)}}function gf(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,a,c;return i(this,(function(i){switch(i.label){case 0:return(r=fi(t)).Vl.Ba(e,"rejected",n),o=r.xl.get(e),(s=o&&o.key)?(u=(u=new Ms(Li.H)).zt(s,new po(s,Oi.min())),a=Ws().add(s),c=new nu(Oi.min(),new Map,new qs(di),u,a),[4,vf(r,c)]):[3,2];case 1:return i.sent(),r.Cl=r.Cl.remove(s),r.xl.delete(e),Sf(r),[3,4];case 2:return[4,jc(r.bh,e,!1).then((function(){return If(r,e,n)})).catch(Xa)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))}function mf(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:n=fi(t),r=e.batch.batchId,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Lc(n.bh,e)];case 2:return o=i.sent(),_f(n,r,null),Ef(n,r),n.Vl.Na(r,"acknowledged"),[4,Df(n,o)];case 3:return i.sent(),[3,6];case 4:return[4,Xa(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function bf(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:r=fi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,(s=r.bh,u=e,a=fi(s),a.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var e;return a.zo.Pi(t,u).next((function(n){return hi(null!==n),e=n.keys(),a.zo.Ci(t,n)})).next((function(){return a.zo.$i(t)})).next((function(){return a.Tc.Xo(t,e)}))})))];case 2:return o=i.sent(),_f(r,e,n),Ef(r,e),r.Vl.Na(e,"rejected",n),[4,Df(r,o)];case 3:return i.sent(),[3,6];case 4:return[4,Xa(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}var s,u,a}))}))}function wf(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u;return i(this,(function(i){switch(i.label){case 0:Ch((n=fi(t)).yl)||oi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(a=n.bh,c=fi(a),c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return c.zo.Vi(t)})))];case 2:return-1===(r=i.sent())?[2,void e.resolve()]:((o=n.Fl.get(r)||[]).push(e),n.Fl.set(r,o),[3,4]);case 3:return s=i.sent(),u=ea(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}var a,c}))}))}function Ef(t,e){(t.Fl.get(e)||[]).forEach((function(t){t.resolve()})),t.Fl.delete(e)}function _f(t,e,n){var r=fi(t),i=r.$l[r.currentUser.A()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i}}function If(t,e,n){void 0===n&&(n=null),t.Vl.ka(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ml&&t.Nl.Fc(e).forEach((function(e){t.Nl.Fi(e)||Tf(t,e)}))}function Tf(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Dh(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Sf(t))}function Nf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof of?(t.Nl.nr(o.key,e),Af(t,o)):o instanceof sf?(oi("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Fi(o.key)||Tf(t,o.key)):ci()}}function Af(t,e){var n=e.key,r=n.path.rt();t.Cl.get(n)||t.Dl.has(r)||(oi("SyncEngine","New document in limbo: "+n),t.Dl.add(r),Sf(t))}function Sf(t){for(;t.Dl.size>0&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new Li(Pi.ot(e)),r=t.Ol.next();t.xl.set(r,new cf(n)),t.Cl=t.Cl.zt(n,r),Sh(t.yl,new $o(Ho(Mo(n.path)),r,2,Si.q))}}function Df(t,e,n){return r(this,void 0,void 0,(function(){var o,s,u,a;return i(this,(function(c){switch(c.label){case 0:return o=fi(t),s=[],u=[],a=[],o.vl.et()?[3,3]:(o.vl.forEach((function(t,r){a.push(o.Ll(r,e,n).then((function(t){if(t){o.Ml&&o.Vl.Ba(r.targetId,t.fromCache?"not-current":"current"),s.push(t);var e=Oc.oc(r.targetId,t);u.push(e)}})))})),[4,Promise.all(a)]);case 1:return c.sent(),o.bl.ah(s),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h,f;return i(this,(function(i){switch(i.label){case 0:n=fi(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Gu.forEach(e,(function(e){return Gu.forEach(e.ic,(function(r){return n.persistence.Ti.nr(t,e.targetId,r)})).next((function(){return Gu.forEach(e.rc,(function(r){return n.persistence.Ti.ir(t,e.targetId,r)}))}))}))}))];case 2:return i.sent(),[3,4];case 3:if(!Xu(r=i.sent()))throw r;return oi("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(o=0,s=e;o<s.length;o++)u=s[o],a=u.targetId,u.fromCache||(c=n.fc.get(a),h=c.Ot,f=c.Lt(h),n.fc=n.fc.zt(a,f));return[2]}}))}))}(o.bh,u)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Of(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=fi(t)).currentUser.isEqual(e)?[3,3]:(oi("SyncEngine","User change. New user:",e.A()),[4,Cc(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).Fl.forEach((function(t){t.forEach((function(t){t.reject(new bi(mi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),o.Fl.clear(),n.Vl.Ua(e,r.mc,r.Ac),[4,Df(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}var o}))}))}function xf(t,e){var n=fi(t),r=n.xl.get(e);if(r&&r.Pl)return Ws().add(r.key);var i=Ws(),o=n.Sl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.vl.get(a);i=i.Pe(c.view._l)}return i}function Pf(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,Fc((n=fi(t)).bh,e.query,!0)];case 1:return r=i.sent(),o=e.view.Al(r),[2,(n.Ml&&Nf(n,e.targetId,o.Il),o)]}}))}))}function kf(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){return[2,zc((e=fi(t)).bh).then((function(t){return Df(e,t)}))]}))}))}function Cf(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return[4,(u=(r=fi(t)).bh,a=e,c=fi(u),h=fi(c.zo),c.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return h.yi(t,a).next((function(e){return e?c.Tc.Xo(t,e):Gu.resolve(null)}))})))];case 1:return null===(s=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,Fh(r.yl)];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(_f(r,e,o||null),Ef(r,e),function(t,e){fi(fi(t).zo).xi(e)}(r.bh,e)):ci(),i.label=4;case 4:return[4,Df(r,s)];case 5:return i.sent(),[3,7];case 6:oi("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}var u,a,c,h}))}))}function Lf(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h;return i(this,(function(i){switch(i.label){case 0:return Ff(n=fi(t)),qf(n),!0!==e||!0===n.kl?[3,3]:(r=n.Vl.va(),[4,Rf(n,r.it())]);case 1:return o=i.sent(),n.kl=!0,[4,Kh(n.yl,!0)];case 2:for(i.sent(),s=0,u=o;s<u.length;s++)a=u[s],Sh(n.yl,a);return[3,7];case 3:return!1!==e||!1===n.kl?[3,7]:(c=[],h=Promise.resolve(),n.Sl.forEach((function(t,e){n.Vl.Ma(e)?c.push(e):h=h.then((function(){return If(n,e),jc(n.bh,e,!0)})),Dh(n.yl,e)})),[4,h]);case 4:return i.sent(),[4,Rf(n,c)];case 5:return i.sent(),(f=fi(n)).xl.forEach((function(t,e){Dh(f.yl,e)})),f.Nl.Oc(),f.xl=new Map,f.Cl=new Ms(Li.H),n.kl=!1,[4,Kh(n.yl,!1)];case 6:i.sent(),i.label=7;case 7:return[2]}var f}))}))}function Rf(t,e,n){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h,f,l,p,d,v,y;return i(this,(function(i){switch(i.label){case 0:n=fi(t),r=[],o=[],s=0,u=e,i.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=n.Sl.get(a))&&0!==h.length?[4,Mc(n.bh,Ho(h[0]))]:[3,7]):[3,13];case 2:c=i.sent(),f=0,l=h,i.label=3;case 3:return f<l.length?(p=l[f],d=n.vl.get(p),[4,Pf(n,d)]):[3,6];case 4:(v=i.sent()).snapshot&&o.push(v.snapshot),i.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,qc(n.bh,a)];case 8:return y=i.sent(),[4,Mc(n.bh,y)];case 9:return c=i.sent(),[4,lf(n,Vf(y),a,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return s++,[3,1];case 13:return[2,(n.bl.ah(o),r)]}}))}))}function Vf(t){return Uo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Uf(t){var e=fi(t);return fi(fi(e.bh).persistence).Uo()}function Mf(t,e,n,o){return r(this,void 0,void 0,(function(){var r,s,u;return i(this,(function(i){switch(i.label){case 0:return(r=fi(t)).kl?(oi("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!r.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,zc(r.bh)];case 3:return s=i.sent(),u=nu.Me(e,"current"===n),[4,Df(r,s,u)];case 4:return i.sent(),[3,8];case 5:return[4,jc(r.bh,e,!0)];case 6:return i.sent(),If(r,e,o),[3,8];case 7:ci(),i.label=8;case 8:return[2]}}))}))}function jf(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,a,c,h,f,l,p;return i(this,(function(d){switch(d.label){case 0:if(!(r=Ff(t)).kl)return[3,10];o=0,s=e,d.label=1;case 1:return o<s.length?(u=s[o],r.Sl.has(u)?(oi("SyncEngine","Adding an already active target "+u),[3,5]):[4,qc(r.bh,u)]):[3,6];case 2:return a=d.sent(),[4,Mc(r.bh,a)];case 3:return c=d.sent(),[4,lf(r,Vf(a),c.targetId,!1)];case 4:d.sent(),Sh(r.yl,c),d.label=5;case 5:return o++,[3,1];case 6:h=function(t){return i(this,(function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,jc(r.bh,t,!1).then((function(){Dh(r.yl,t),If(r,t)})).catch(Xa)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,d.label=7;case 7:return f<l.length?(p=l[f],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function Ff(t){var e=fi(t);return e.yl.Dh.Lh=vf.bind(null,e),e.yl.Dh.vn=xf.bind(null,e),e.yl.Dh.Mh=gf.bind(null,e),e.bl.ah=tf.bind(null,e.gl),e.bl.Bl=ef.bind(null,e.gl),e}function qf(t){var e=fi(t);return e.yl.Dh.Bh=mf.bind(null,e),e.yl.Dh.qh=bf.bind(null,e),e}var zf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.Qt=gh(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}}))}))},t.prototype.zl=function(t){return null},t.prototype.Hl=function(t){return kc(this.persistence,new xc,t.Jl,this.Qt)},t.prototype.jl=function(t){return new Jc($c.ia,this.Qt)},t.prototype.Wl=function(t){return new ch},t.prototype.terminate=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}}))}))},t}(),Bf=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).Yl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Bc(this.bh)];case 2:return n.sent(),[4,this.Yl.initialize(this,e)];case 3:return n.sent(),[4,qf(this.Yl._a)];case 4:return n.sent(),[4,Fh(this.Yl.yl)];case 5:return n.sent(),[2]}}))}))},n.prototype.Hl=function(t){return kc(this.persistence,new xc,t.Jl,this.Qt)},n.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new lc(e,t._s)},n.prototype.jl=function(t){var e=Sc(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?Qa.Ys(this.cacheSizeBytes):Qa.ti;return new Tc(this.synchronizeTabs,e,t.clientId,n,t._s,vh(),yh(),this.Qt,this.Vl,!!this.forceOwnership)},n.prototype.Wl=function(t){return new ch},n}(zf),Gf=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Yl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return e(n,t),n.prototype.initialize=function(e){return r(this,void 0,void 0,(function(){var n,o=this;return i(this,(function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return s.sent(),n=this.Yl._a,this.Vl instanceof ah?(this.Vl._a={eu:Cf.bind(null,n),nu:Mf.bind(null,n),su:jf.bind(null,n),Uo:Uf.bind(null,n),tu:kf.bind(null,n)},[4,this.Vl.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.Ro((function(t){return r(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,Lf(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}}))}))}))];case 4:return s.sent(),[2]}}))}))},n.prototype.Wl=function(t){var e=vh();if(!ah.Kn(e))throw new bi(mi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Sc(t.yu.t,t.yu.persistenceKey);return new ah(e,t._s,n,t.clientId,t.Jl)},n}(Bf),Hf=function(){function t(){}return t.prototype.initialize=function(t,e){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return yf(n._a,t,1)},this.yl.Dh.n_=Of.bind(null,this._a),[4,Kh(this.yl,this._a.Ml)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.t_=function(t){return new Jh},t.prototype.Xl=function(t){var e,n,r=gh(t.yu.t),i=(e=t.yu,new dh(e));return n=t.credentials,new _h(n,i,r)},t.prototype.Zl=function(t){var e,n,r,i,o,s=this;return e=this.bh,n=this.Sh,r=t._s,i=function(t){return yf(s._a,t,0)},o=fh.Kn()?new fh:new hh,new Th(e,n,r,i,o)},t.prototype.e_=function(t,e){return n=this.bh,r=this.yl,i=this.gl,o=this.Vl,s=t.Jl,u=t.pl,a=e,c=new hf(n,r,i,o,s,u),a&&(c.kl=!0),c;var n,r,i,o,s,u,a,c},t.prototype.terminate=function(){return function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=fi(t),oi("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,Ah(e)];case 1:return n.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}}))}))}(this.yl)},t}(),Yf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.i_=function(){this.muted=!0},t.prototype.s_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Kf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new bi(mi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new Ci(t)}return t.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},t}(),Qf=function(t){this._methodName=t},Xf=function(t){this.d_=t};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Wf(t,e,n){if(!n)throw new bi(mi.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Jf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new bi(mi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zf(t,e,n,r){if(!0===e&&!0===r)throw new bi(mi.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function $f(t){if(!Li.wt(t))throw new bi(mi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function tl(t){if(Li.wt(t))throw new bi(mi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function el(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ci()}function nl(t,e){if("_delegate"in t&&(t=t.d_),!(t instanceof e)){if(e.name===t.constructor.name)throw new bi(mi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=el(t);throw new bi(mi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function rl(t,e){if(e<=0)throw new bi(mi.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var il=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new bi(mi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new bi(mi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Zf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),ol=new Map,sl=function(){function t(t,e){this.w_="(lite)",this.E_=new il({}),this.T_=!1,t instanceof ni?(this.I_=t,this.m_=new Ii):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new bi(mi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(t.options.projectId)}(t),this.m_=new Ti(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new bi(mi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new bi(mi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new il(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Ii;switch(t.type){case"gapi":var e=t.client;return hi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ai(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new bi(mi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},t.prototype.b_=function(){return this,(t=ol.get(this))&&(oi("ComponentProvider","Removing Datastore"),ol.delete(this),t.terminate()),Promise.resolve();var t},t}(),ul=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new cl(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),al=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),cl=function(t){function n(e,n,r){var i=this;return(i=t.call(this,e,n,Mo(r))||this).firestore=e,i.D_=r,i.type="collection",i}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new ul(this.firestore,null,new Li(t))},enumerable:!1,configurable:!0}),n.prototype.withConverter=function(t){return new n(this.firestore,t,this.D_)},n}(al);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Xf&&(t=t.d_),Wf("collection","path",e),t instanceof sl)return tl(n=Pi.ot.apply(Pi,s([e],r))),new cl(t,null,n);if(!(t instanceof ul||t instanceof cl))throw new bi(mi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tl(n=Pi.ot.apply(Pi,s([t.path],r)).child(Pi.ot(e))),new cl(t.firestore,null,n)}function fl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Xf&&(t=t.d_),1===arguments.length&&(e=pi.u()),Wf("doc","path",e),t instanceof sl)return $f(n=Pi.ot.apply(Pi,s([e],r))),new ul(t,null,new Li(n));if(!(t instanceof ul||t instanceof cl))throw new bi(mi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return $f(n=t.D_.child(Pi.ot.apply(Pi,s([e],r)))),new ul(t.firestore,t instanceof cl?t.v_:null,new Li(n))}function ll(t,e){return t instanceof Xf&&(t=t.d_),e instanceof Xf&&(e=e.d_),(t instanceof ul||t instanceof cl)&&(e instanceof ul||e instanceof cl)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function pl(t,e){return t instanceof Xf&&(t=t.d_),e instanceof Xf&&(e=e.d_),t instanceof al&&e instanceof al&&t.firestore===e.firestore&&Ko(t.C_,e.C_)&&t.v_===e.v_}var dl=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new bi(mi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new bi(mi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.U=function(t){return di(this.x_,t.x_)||di(this.N_,t.N_)},t}(),vl=/^__.*__$/,yl=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Gt?new As(t,this.data,this.Gt,e,this.fieldTransforms):new Ns(t,this.data,e,this.fieldTransforms)},t}(),gl=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new As(t,this.data,this.Gt,e,this.fieldTransforms)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ci()}}var bl=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return jl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Gt.find((function(e){return t.nt(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.nt(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(ml(this.k_)&&vl.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),wl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||gh(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new bl({k_:t,methodName:e,j_:n,path:Ci.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},t}();function El(t){var e=t.p_(),n=gh(t.I_);return new wl(t.I_,!!e.ignoreUndefinedProperties,n)}function _l(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Rl("Data must be an object, but it was:",s,r);var u,a,c=Cl(r,s);if(o.merge)u=new Mi(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Vl(e,l[f],n);if(!s.contains(p))throw new bi(mi.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Fl(h,p)||h.push(p)}u=new Mi(h),a=s.fieldTransforms.filter((function(t){return u.Tt(t.field)}))}else u=null,a=s.fieldTransforms;return new yl(new ao(c),u,a)}var Il=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},n.prototype.isEqual=function(t){return t instanceof n},n}(Qf);function Tl(t,e,n){return new bl({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Nl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.z_=function(t){return new vs(t.path,new us)},n.prototype.isEqual=function(t){return t instanceof n},n}(Qf),Al=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return e(n,t),n.prototype.z_=function(t){var e=Tl(this,t,!0),n=this.H_.map((function(t){return kl(t,e)})),r=new as(n);return new vs(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(Qf),Sl=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return e(n,t),n.prototype.z_=function(t){var e=Tl(this,t,!0),n=this.H_.map((function(t){return kl(t,e)})),r=new hs(n);return new vs(t.path,r)},n.prototype.isEqual=function(t){return this===t},n}(Qf),Dl=function(t){function n(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return e(n,t),n.prototype.z_=function(t){var e=new ls(t.Qt,ns(t.Qt,this.J_));return new vs(t.path,e)},n.prototype.isEqual=function(t){return this===t},n}(Qf);function Ol(t,e,n,r){var i=t.G_(1,e,n);Rl("Data must be an object, but it was:",i,r);var o=[],s=new co;Vi(r,(function(t,r){var u=Ml(e,t,n);r instanceof Xf&&(r=r.d_);var a=i.U_(u);if(r instanceof Il)o.push(u);else{var c=kl(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new Mi(o);return new gl(s.Pt(),u,i.fieldTransforms)}function xl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Vl(e,r,n)],a=[i];if(o.length%2!=0)throw new bi(mi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Vl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new co,l=u.length-1;l>=0;--l)if(!Fl(h,u[l])){var p=u[l],d=a[l];d instanceof Xf&&(d=d.d_);var v=s.U_(p);if(d instanceof Il)h.push(p);else{var y=kl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Mi(h);return new gl(f.Pt(),g,s.fieldTransforms)}function Pl(t,e,n,r){return void 0===r&&(r=!1),kl(n,t.G_(r?4:3,e))}function kl(t,e){if(t instanceof Xf&&(t=t.d_),Ll(t))return Rl("Unsupported field value:",e,t),Cl(t,e);if(t instanceof Qf)return function(t,e){if(!ml(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=kl(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Xf&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ns(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:du(e.Qt,n)}}if(t instanceof Di)return n=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:du(e.Qt,n)};if(t instanceof dl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:vu(e.Qt,t.I)};if(t instanceof ul){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:mu(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+el(t))}(t,e)}function Cl(t,e){var n={};return Ui(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):Vi(t,(function(t,r){var i=kl(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ll(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof dl||t instanceof wi||t instanceof ul||t instanceof Qf)}function Rl(t,e,n){if(!Ll(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=el(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}var i}function Vl(t,e,n){if(e instanceof Xf&&(e=e.d_),e instanceof Kf)return e.f_;if("string"==typeof e)return Ml(t,e);throw jl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ul=new RegExp("[~\\*/\\[\\]]");function Ml(t,e,n){if(e.search(Ul)>=0)throw jl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Kf.bind.apply(Kf,s([void 0],e.split("."))))).f_}catch(r){throw jl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function jl(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new bi(mi.INVALID_ARGUMENT,(u+=". ")+t+a)}function Fl(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ql=function(){function t(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return r(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){switch(o.label){case 0:if(this.nf(),this.mutations.length>0)throw new bi(mi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,a;return i(this,(function(i){switch(i.label){case 0:return n=fi(t),r=Tu(n.Qt)+"/documents",o={documents:e.map((function(t){return wu(n.Qt,t)}))},[4,n.Du("BatchGetDocuments",r,o)];case 1:return s=i.sent(),u=new Map,s.forEach((function(t){var e,r,i=(e=n.Qt,"found"in(r=t)?function(t,e){hi(!!e.found),e.found.name,e.found.updateTime;var n=Eu(t,e.found.name),r=gu(e.found.updateTime),i=new ao({mapValue:{fields:e.found.fields}});return new lo(n,r,i,{})}(e,r):"missing"in r?function(t,e){hi(!!e.missing),hi(!!e.readTime);var n=Eu(t,e.missing),r=gu(e.readTime);return new po(n,r)}(e,r):ci());u.set(i.key.toString(),i)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());hi(!!e),a.push(e)})),a)]}}))}))}(this.Sh,t)];case 1:return[2,((e=o.sent()).forEach((function(t){t instanceof po||t instanceof lo?n.sf(t):ci()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(n){this.Z_=n}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Cs(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Li._t(n);e.mutations.push(new Ls(r,e.jt(r)))})),[4,function(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=fi(t),r=Tu(n.Qt)+"/documents",o={writes:e.map((function(t){return Su(n.Qt,t)}))},[4,n.pu("Commit",r,o)];case 1:return i.sent(),[2]}}))}))}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof lo)e=t.version;else{if(!(t instanceof po))throw ci();e=Oi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new bi(mi.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?gs.updateTime(e):gs.Kt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(Oi.min()))throw new bi(mi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)}return gs.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),zl=function(){function t(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new mh(this._s,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.Gu.Lu((function(){return r(t,void 0,void 0,(function(){var t,e,n=this;return i(this,(function(r){return t=new ql(this.Sh),(e=this.uf(t))&&e.then((function(e){n._s.Ps((function(){return t.commit().then((function(){n.Es.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Yi(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.Es.reject(n),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps((function(){return e.af(),Promise.resolve()}))):this.Es.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Vs(e)}return!1},t}(),Bl=function(){function t(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Ei.UNAUTHENTICATED,this.clientId=pi.u(),this._f=function(){},this.C=new Bu,this.credentials.v((function(t){oi("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()}))}return t.prototype.getConfiguration=function(){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this._s.wf)throw new bi(mi.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this._s.Ef();var e=new Bu;return this._s.Tf((function(){return r(t,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=r.sent(),n=ea(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(t,e){return r(this,void 0,void 0,(function(){var n,o,s=this;return i(this,(function(u){switch(u.label){case 0:return t._s.Af(),oi("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=u.sent(),[4,e.initialize(n)];case 2:return u.sent(),o=n.Jl,t.ff((function(n){o.isEqual(n)||(o=n,t._s.po((function(){return r(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,Cc(e.bh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.Po((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function Hl(t,e){return r(this,void 0,void 0,(function(){var n,o;return i(this,(function(s){switch(s.label){case 0:return t._s.Af(),[4,Yl(t)];case 1:return n=s.sent(),oi("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return o=s.sent(),[4,e.initialize(n,o)];case 3:return s.sent(),t.ff((function(n){return t._s.po((function(){return function(t,e){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=fi(t))._s.Af(),oi("RemoteStore","RemoteStore received new credentials"),r=Ch(n),n.Nh.add(3),[4,Ah(n)];case 1:return i.sent(),r&&n.Oh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,Nh(n)];case 3:return i.sent(),[2]}}))}))}(e.yl,n)}))})),t.If=e,[2]}}))}))}function Yl(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(oi("FirestoreClient","Using default OfflineComponentProvider"),[4,Gl(t,new zf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function Kl(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(oi("FirestoreClient","Using default OnlineComponentProvider"),[4,Hl(t,new Hf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function Ql(t){return Yl(t).then((function(t){return t.persistence}))}function Xl(t){return Yl(t).then((function(t){return t.bh}))}function Wl(t){return Kl(t).then((function(t){return t.yl}))}function Jl(t){return Kl(t).then((function(t){return t._a}))}function Zl(t){return r(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,Kl(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=ff.bind(null,e._a),n.Hh=pf.bind(null,e._a),n)]}}))}))}function $l(t,e,n){var o=this;void 0===n&&(n={});var s=new Bu;return t._s.Ps((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new Yf({next:function(o){e.Ps((function(){return $h(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new bi(mi.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new bi(mi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new rf(Mo(n.path),o,{includeMetadataChanges:!0,nl:!0});return Zh(t,s)},[4,Zl(t)];case 1:return[2,r.apply(void 0,[i.sent(),t._s,e,n,s])]}}))}))})),s.promise}function tp(t,e,n){var o=this;void 0===n&&(n={});var s=new Bu;return t._s.Ps((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new Yf({next:function(n){e.Ps((function(){return $h(t,s)})),n.fromCache&&"server"===r.source?i.reject(new bi(mi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new rf(n,o,{includeMetadataChanges:!0,nl:!0});return Zh(t,s)},[4,Zl(t)];case 1:return[2,r.apply(void 0,[i.sent(),t._s,e,n,s])]}}))}))})),s.promise}var ep=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new mh(this,"async_queue_retry"),this.vf=function(){var e=yh();e&&oi("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=yh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ps=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=yh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.po=function(t){var e=this;this.Ps((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return r(this,void 0,void 0,(function(){var t,e=this;return i(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!Xu(t=n.sent()))throw t;return oi("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.Lu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,si("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),t;var n,r})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.Tr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=ta.Ts(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&ci()},t.prototype.Af=function(){},t.prototype.Nf=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ds-e.ds}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()}))},t.prototype.Of=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}();function np(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var rp=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).Bf=new ep,r.w_="name"in e?e.name:"[DEFAULT]",r}return e(n,t),n.prototype.b_=function(){return this.qf||op(this),this.qf.terminate()},n}(sl);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t){return t.qf||op(t),t.qf.df(),t.qf}function op(t){var e,n,r,i=t.p_(),o=(e=t.I_,n=t.w_,new ei(e,n,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.qf=new Bl(t.m_,t.Bf,o)}function sp(t,e,n){var o=this,s=new Bu;return t._s.enqueue((function(){return r(o,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Gl(t,n)];case 1:return i.sent(),[4,Hl(t,e)];case 2:return i.sent(),s.resolve(),[3,4];case 3:if(!("FirebaseError"===(o=r=i.sent()).name?o.code===mi.FAILED_PRECONDITION||o.code===mi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),s.reject(r),[3,4];case 4:return[2]}var o}))}))})).then((function(){return s.promise}))}function up(t){if(t.R_||t.P_)throw new bi(mi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ap=function(){function t(){}return t.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Xi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qi(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(zi(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw ci()}},t.prototype.Hf=function(t,e){var n=this,r={};return Vi(t.fields||{},(function(t,i){r[t]=n.Uf(i,e)})),r},t.prototype.Gf=function(t){return new dl(qi(t.latitude),qi(t.longitude))},t.prototype.zf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.Uf(t,e)}))},t.prototype.Kf=function(t,e){switch(e){case"previous":var n=Gi(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Hi(t));default:return null}},t.prototype.Qf=function(t){var e=Fi(t);return new Di(e.seconds,e.nanos)},t.prototype.Jf=function(t,e){var n=Pi.ot(t);hi(zu(n));var r=new ni(n.get(1),n.get(3)),i=new Li(n.Y(5));return r.isEqual(e)||si("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),cp=function(){function t(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ul(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Zf},t.prototype.data=function(){if(this.Zf){if(this.v_){var t=new hp(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},t.prototype.get=function(t){if(this.Zf){var e=this.Zf.data().field(fp("DocumentSnapshot.get",t));if(null!==e)return this.Xf.Uf(e)}},t}(),hp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(){return t.prototype.data.call(this)},n}(cp);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(t,e){return"string"==typeof e?Ml(t,e):e instanceof Xf?e.d_.f_:e.f_}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(t){if(Fo(t)&&0===t.xt.length)throw new bi(mi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pp=function(){};function dp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.td(t)}return t}var vp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).ed=e,i.nd=n,i.sd=r,i.type="where",i}return e(n,t),n.prototype.td=function(t){var e,n,r,i=El(t.firestore),o=function(t,e,n,r,i,o,s){var u;if(i.ut()){if("array-contains"===o||"array-contains-any"===o)throw new bi(mi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){_p(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Ep(r,t,f))}u={arrayValue:{values:a}}}else u=Ep(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||_p(s,o),u=Pl(n,"where",s,"in"===o||"not-in"===o);var l=Eo.create(i,o,u);return function(t,e){if(e.Ct()){var n=zo(t);if(null!==n&&!n.isEqual(e.field))throw new bi(mi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=qo(t);null!==r&&Ip(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new bi(mi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new bi(mi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,i,t.firestore.I_,this.ed,this.nd,this.sd);return new al(t.firestore,t.v_,(e=t.C_,n=o,r=e.filters.concat([n]),new Vo(e.path,e.collectionGroup,e.xt.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)))},n}(pp),yp=function(t){function n(e,n){var r=this;return(r=t.call(this)||this).ed=e,r.rd=n,r.type="orderBy",r}return e(n,t),n.prototype.td=function(t){var e,n,r,i=function(t,e,n){if(null!==t.startAt)throw new bi(mi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new bi(mi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ko(e,n);return function(t,e){if(null===qo(t)){var n=zo(t);null!==n&&Ip(t,n,e.field)}}(t,r),r}(t.C_,this.ed,this.rd);return new al(t.firestore,t.v_,(e=t.C_,n=i,r=e.xt.concat([n]),new Vo(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))},n}(pp),gp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.od=n,i.ad=r,i}return e(n,t),n.prototype.td=function(t){return new al(t.firestore,t.v_,Yo(t.C_,this.od,this.ad))},n}(pp),mp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return e(n,t),n.prototype.td=function(t){var e,n,r=wp(t,this.type,this.ud,this.hd);return new al(t.firestore,t.v_,(e=t.C_,n=r,new Vo(e.path,e.collectionGroup,e.xt.slice(),e.filters.slice(),e.limit,e.limitType,n,e.endAt)))},n}(pp),bp=function(t){function n(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return e(n,t),n.prototype.td=function(t){var e,n,r=wp(t,this.type,this.ud,this.hd);return new al(t.firestore,t.v_,(e=t.C_,n=r,new Vo(e.path,e.collectionGroup,e.xt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,n)))},n}(pp);function wp(t,e,n,r){if(n[0]instanceof Xf&&(n[0]=n[0].d_),n[0]instanceof cp)return function(t,e,n,r,i){if(!r)throw new bi(mi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Go(t);s<u.length;s++){var a=u[s];if(a.field.ut())o.push(no(e,r.key));else{var c=r.field(a.field);if(Bi(c))throw new bi(mi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.rt();throw new bi(mi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new xo(o,i)}(t.C_,t.firestore.I_,e,n[0].Zf,r);var i=El(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new bi(mi.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new bi(mi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Bo(t)&&-1!==c.indexOf("/"))throw new bi(mi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Pi.ot(c));if(!Li.wt(h))throw new bi(mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Li(h);u.push(no(e,f))}else{var l=Pl(n,r,c);u.push(l)}}return new xo(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Ep(t,e,n){if(n instanceof Xf&&(n=n.d_),"string"==typeof n){if(""===n)throw new bi(mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bo(e)&&-1!==n.indexOf("/"))throw new bi(mi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Pi.ot(n));if(!Li.wt(r))throw new bi(mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return no(t,new Li(r))}if(n instanceof ul)return no(t,n.S_);throw new bi(mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+el(n)+".")}function _p(t,e){if(!Array.isArray(t)||0===t.length)throw new bi(mi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new bi(mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ip(t,e,n){if(!n.isEqual(e))throw new bi(mi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Np=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.Wf=function(t){return new wi(t)},n.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new ul(this.firestore,null,e)},n}(ap),Ap=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Sp=function(t){function n(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).Yf=e,u.ld=e,u.metadata=o,u}return e(n,t),n.prototype.exists=function(){return t.prototype.exists.call(this)},n.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new Dp(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},n.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){var n=this.Zf.data().field(fp("DocumentSnapshot.get",t));if(null!==n)return this.Xf.Uf(n,e.serverTimestamps)}},n}(cp),Dp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},n}(Sp),Op=function(){function t(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new Ap(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach((function(r){t.call(e,new Dp(n.Yf,n.Xf,r.key,r,new Ap(n._d.De.has(r.key),n._d.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._d.xe)throw new bi(mi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===e||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map((function(e){var r=new Dp(t.Yf,t.Xf,e.doc.key,e.doc,new Ap(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._d.Se;return t._d.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Dp(t.Yf,t.Xf,e.doc.key,e.doc,new Ap(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:xp(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.dd=e),this.fd},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ci()}}function Pp(t,e){return t instanceof Sp&&e instanceof Sp?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Op&&e instanceof Op&&t.Yf===e.Yf&&pl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.Wf=function(t){return new wi(t)},n.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new ul(this.firestore,null,e)},n}(ap);function Cp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=nl(t,ul);var o=nl(t.firestore,rp),s=El(o);return e instanceof Xf&&(e=e.d_),Rp(o,[("string"==typeof e||e instanceof Kf?xl(s,"updateDoc",t.S_,e,n,r):Ol(s,"updateDoc",t.S_,e)).F_(t.S_,gs.exists(!0))])}function Lp(t){for(var e,n,o,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];t instanceof Xf&&(t=t.d_);var a={includeMetadataChanges:!1},c=0;"object"!=typeof s[c]||np(s[c])||(a=s[c],c++);var h,f,l,p={includeMetadataChanges:a.includeMetadataChanges};if(np(s[c])){var d=s[c];s[c]=null===(e=d.next)||void 0===e?void 0:e.bind(d),s[c+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),s[c+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(t instanceof ul)f=nl(t.firestore,rp),l=Mo(t.S_.path),h={next:function(e){s[c]&&s[c](Vp(f,t,e))},error:s[c+1],complete:s[c+2]};else{var v=nl(t,al);f=nl(v.firestore,rp),l=v.C_;var y=new kp(f);h={next:function(t){s[c]&&s[c](new Op(f,y,v,t))},error:s[c+1],complete:s[c+2]},lp(t.C_)}return function(t,e,n,o){var s=this,u=new Yf(o),a=new rf(e,u,n);return t._s.Ps((function(){return r(s,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=Zh,[4,Zl(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){u.i_(),t._s.Ps((function(){return r(s,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=$h,[4,Zl(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(ip(f),l,p,h)}function Rp(t,e){return function(t,e){var n=this,o=new Bu;return t._s.Ps((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=df,[4,Jl(t)];case 1:return[2,n.apply(void 0,[r.sent(),e,o])]}}))}))})),o.promise}(ip(t),e)}function Vp(t,e,n){var r=n.docs.get(e.S_),i=new kp(t);return new Sp(t,i,e.S_,r,new Ap(n.hasPendingWrites,n.fromCache),e.v_)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Up=function(){function t(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=El(t)}return t.prototype.set=function(t,e,n){this.md();var r=Mp(t,this.Yf),i=Tp(r.v_,e,n),o=_l(this.Id,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.Ed.push(o.F_(r.S_,gs.Kt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();var o,s=Mp(t,this.Yf);return e instanceof Xf&&(e=e.d_),o="string"==typeof e||e instanceof Kf?xl(this.Id,"WriteBatch.update",s.S_,e,n,r):Ol(this.Id,"WriteBatch.update",s.S_,e),this.Ed.push(o.F_(s.S_,gs.exists(!0))),this},t.prototype.delete=function(t){this.md();var e=Mp(t,this.Yf);return this.Ed=this.Ed.concat(new Cs(e.S_,gs.Kt())),this},t.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Td)throw new bi(mi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Mp(t,e){if(t instanceof Xf&&(t=t.d_),t.firestore!==e)throw new bi(mi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jp=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).Yf=e,r}return e(n,t),n.prototype.get=function(e){var n=this,r=Mp(e,this.Yf),i=new kp(this.Yf);return t.prototype.get.call(this,e).then((function(t){return new Sp(n.Yf,i,r.S_,t.Zf,new Ap(!1,!1),r.v_)}))},n}(function(){function t(t,e){this.Yf=t,this.Ad=e,this.Id=El(t)}return t.prototype.get=function(t){var e=this,n=Mp(t,this.Yf),r=new Np(this.Yf);return this.Ad.ef([n.S_]).then((function(t){if(!t||1!==t.length)return ci();var i=t[0];if(i instanceof po)return new cp(e.Yf,r,n.S_,null,n.v_);if(i instanceof lo)return new cp(e.Yf,r,i.key,i,n.v_);throw ci()}))},t.prototype.set=function(t,e,n){var r=Mp(t,this.Yf),i=Tp(r.v_,e,n),o=_l(this.Id,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Ad.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Mp(t,this.Yf);return e instanceof Xf&&(e=e.d_),o="string"==typeof e||e instanceof Kf?xl(this.Id,"Transaction.update",s.S_,e,n,r):Ol(this.Id,"Transaction.update",s.S_,e),this.Ad.update(s.S_,o),this},t.prototype.delete=function(t){var e=Mp(t,this.Yf);return this.Ad.delete(e.S_),this},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(){if("undefined"==typeof Uint8Array)throw new bi(mi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qp(){if("undefined"==typeof atob)throw new bi(mi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var zp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.fromBase64String=function(t){return qp(),new n(wi.fromBase64String(t))},n.fromUint8Array=function(t){return Fp(),new n(wi.fromUint8Array(t))},n.prototype.toBase64=function(){return qp(),this.d_.toBase64()},n.prototype.toUint8Array=function(){return Fp(),this.d_.toUint8Array()},n.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},n.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},n}(Xf),Bp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){up(t=nl(t,rp));var n=ip(t),r=t.p_(),i=new Hf;return sp(n,i,new Bf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){up(t=nl(t,rp));var e=ip(t),n=t.p_(),r=new Hf;return sp(e,r,new Gf(r,n.cacheSizeBytes))}(t.d_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new bi(mi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Bu;return t.Bf.Tf((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return Yu.Kn()?(e=t+"main",[4,Yu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Sc(t.I_,t.w_))];case 1:return o.sent(),n.resolve(),[3,3];case 2:return e=o.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.d_)},t}(),Gp=function(t){function n(e,n,r){var i=this;return(i=t.call(this,n)||this).Rd=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof ni||(i.Pd=e),i}return e(n,t),Object.defineProperty(n.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),n.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},n.prototype.useEmulator=function(t,e){var n,r,i,o;n=this.d_,r=t,i=e,"firestore.googleapis.com"!==(o=(n=nl(n,sl)).V_()).host&&o.host!==r&&ui("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},o),{host:r+":"+i,ssl:!1}))},n.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return[4,Ql(t)];case 1:return e=r.sent(),[4,Wl(t)];case 2:return n=r.sent(),[2,(e.yo(!0),i=n,o=fi(i),o.Nh.delete(0),Nh(o))]}var i,o}))}))}))}(ip(nl(this.d_,rp)))},n.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(o){switch(o.label){case 0:return[4,Ql(t)];case 1:return e=o.sent(),[4,Wl(t)];case 2:return n=o.sent(),[2,(e.yo(!1),function(t){return r(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return(e=fi(t)).Nh.add(0),[4,Ah(e)];case 1:return n.sent(),e.Oh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(ip(nl(this.d_,rp)))},n.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Zf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},n.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},n.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},n.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Bu;return t._s.Ps((function(){return r(e,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return e=wf,[4,Jl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(ip(nl(this.d_,rp)))},n.prototype.onSnapshotsInSync=function(t){return e=this.d_,n=t,function(t,e){var n=this,o=new Yf(e);return t._s.Ps((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=function(t,e){fi(t).Wh.add(e),e.next()},[4,Zl(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))})),function(){o.i_(),t._s.Ps((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e=function(t,e){fi(t).Wh.delete(e)},[4,Zl(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))}))}}(ip(e=nl(e,rp)),np(n)?n:{next:n});var e,n},Object.defineProperty(n.prototype,"app",{get:function(){if(!this.Pd)throw new bi(mi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),n.prototype.collection=function(t){try{return new id(this,hl(this.d_,t))}catch(e){throw Wp(e,"collection()","Firestore.collection()")}},n.prototype.doc=function(t){try{return new Xp(this,fl(this.d_,t))}catch(e){throw Wp(e,"doc()","Firestore.doc()")}},n.prototype.collectionGroup=function(t){try{return new ed(this,function(t,e){if(t=nl(t,sl),Wf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new bi(mi.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new al(t,null,(n=e,new Vo(Pi.ct(),n)));var n}(this.d_,t))}catch(e){throw Wp(e,"collectionGroup()","Firestore.collectionGroup()")}},n.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,o=new Bu;return t._s.Ps((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,(i=t,Kl(i).then((function(t){return t.Sh})))];case 1:return n=r.sent(),new zl(t._s,n,e,o).run(),[2]}var i}))}))})),o.promise}(ip(e=this.d_),(function(r){return function(e){return t(new Yp(n,e))}(new jp(e,r))}))},n.prototype.batch=function(){var t=this;return ip(this.d_),new Kp(new Up(this.d_,(function(e){return Rp(t.d_,e)})))},n.prototype.loadBundle=function(t){throw new bi(mi.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},n.prototype.namedQuery=function(t){throw new bi(mi.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},n}(Xf),Hp=function(t){function n(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return e(n,t),n.prototype.Wf=function(t){return new zp(new wi(t))},n.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return Xp.yd(e,this.firestore,null)},n}(ap);var Yp=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r.Xf=new Hp(e),r}return e(n,t),n.prototype.get=function(t){var e=this,n=od(t);return this.d_.get(n).then((function(t){return new $p(e.Yf,new Sp(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))}))},n.prototype.set=function(t,e,n){var r=od(t);return n?(Jf("Transaction.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},n.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=od(t);return 2===arguments.length?this.d_.update(u,e):(r=this.d_).update.apply(r,s([u,e,n],i)),this},n.prototype.delete=function(t){var e=od(t);return this.d_.delete(e),this},n}(Xf),Kp=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.set=function(t,e,n){var r=od(t);return n?(Jf("WriteBatch.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},n.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=od(t);return 2===arguments.length?this.d_.update(u,e):(r=this.d_).update.apply(r,s([u,e,n],i)),this},n.prototype.delete=function(t){var e=od(t);return this.d_.delete(e),this},n.prototype.commit=function(){return this.d_.commit()},n}(Xf),Qp=function(t){function n(e,n,r){var i=this;return(i=t.call(this,r)||this).Yf=e,i.Xf=n,i}return e(n,t),n.prototype.fromFirestore=function(t,e){var n=new Dp(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new td(this.Yf,n),null!=e?e:{})},n.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},n.gd=function(t,e){var r=n.Vd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(e);return o||(o=new n(t,new Hp(t),e),i.set(e,o)),o},n}(Xf);Qp.Vd=new WeakMap;var Xp=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new Hp(e),r}return e(n,t),n.pd=function(t,e,r){if(t.length%2!=0)throw new bi(mi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new n(e,new ul(e.d_,r,new Li(t)))},n.yd=function(t,e,r){return new n(e,new ul(e.d_,r,t))},Object.defineProperty(n.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new id(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),n.prototype.collection=function(t){try{return new id(this.firestore,hl(this.d_,t))}catch(e){throw Wp(e,"collection()","DocumentReference.collection()")}},n.prototype.isEqual=function(t){return t instanceof Xf&&(t=t.d_),t instanceof ul&&ll(this.d_,t)},n.prototype.set=function(t,e){e=Jf("DocumentReference.set",e);try{return function(t,e,n){t=nl(t,ul);var r=nl(t.firestore,rp),i=Tp(t.v_,e,n);return Rp(r,[_l(El(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,gs.Kt())])}(this.d_,t,e)}catch(n){throw Wp(n,"setDoc()","DocumentReference.set()")}},n.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Cp(this.d_,t):Cp.apply(void 0,s([this.d_,t,e],n))}catch(i){throw Wp(i,"updateDoc()","DocumentReference.update()")}},n.prototype.delete=function(){return Rp(nl((t=this.d_).firestore,rp),[new Cs(t.S_,gs.Kt())]);var t},n.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Jp(e),i=Zp(e,(function(e){return new $p(t.firestore,new Sp(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))}));return Lp(this.d_,r,i)},n.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=nl(t,ul);var e=nl(t.firestore,rp),n=ip(e),o=new kp(e);return function(t,e){var n=this,o=new Bu;return t._s.Ps((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,(s=t,u=e,a=fi(s),a.persistence.runTransaction("read document","readonly",(function(t){return a.Tc.Ho(t,u)})))];case 1:return(o=i.sent())instanceof lo?n.resolve(o):o instanceof po?n.resolve(null):n.reject(new bi(mi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=i.sent(),o=ea(r,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}var s,u,a}))}))},[4,Xl(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,o])]}}))}))})),o.promise}(n,t.S_).then((function(n){return new Sp(e,o,t.S_,n,new Ap(n instanceof lo&&n.Vt,!0),t.v_)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=nl(t,ul);var e=nl(t.firestore,rp);return $l(ip(e),t.S_,{source:"server"}).then((function(n){return Vp(e,t,n)}))}(this.d_):function(t){t=nl(t,ul);var e=nl(t.firestore,rp);return $l(ip(e),t.S_).then((function(n){return Vp(e,t,n)}))}(this.d_)).then((function(t){return new $p(e.firestore,new Sp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))}))},n.prototype.withConverter=function(t){return new n(this.firestore,t?this.d_.withConverter(Qp.gd(this.firestore,t)):this.d_.withConverter(null))},n}(Xf);function Wp(t,e,n){return t.message=t.message.replace(e,n),t}function Jp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!np(r))return r}return{}}function Zp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=np(t[0])?t[0]:np(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var $p=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return e(n,t),Object.defineProperty(n.prototype,"ref",{get:function(){return new Xp(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),n.prototype.data=function(t){return this.d_.data(t)},n.prototype.get=function(t,e){return this.d_.get(t,e)},n.prototype.isEqual=function(t){return Pp(this.d_,t.d_)},n}(Xf),td=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.data=function(t){return this.d_.data(t)},n}($p),ed=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new Hp(e),r}return e(n,t),n.prototype.where=function(t,e,r){try{return new n(this.firestore,dp(this.d_,(o=r,s=e,u=fp("where",i=t),new vp(u,s,o))))}catch(i){throw Wp(i,/(orderBy|where)\(\)/,"Query.$1()")}var i,o,s,u},n.prototype.orderBy=function(t,e){try{return new n(this.firestore,dp(this.d_,function(t,e){void 0===e&&(e="asc");var n=e,r=fp("orderBy",t);return new yp(r,n)}(t,e)))}catch(r){throw Wp(r,/(orderBy|where)\(\)/,"Query.$1()")}},n.prototype.limit=function(t){try{return new n(this.firestore,dp(this.d_,(rl("limit",e=t),new gp("limit",e,"F"))))}catch(e){throw Wp(e,"limit()","Query.limit()")}var e},n.prototype.limitToLast=function(t){try{return new n(this.firestore,dp(this.d_,(rl("limitToLast",e=t),new gp("limitToLast",e,"L"))))}catch(e){throw Wp(e,"limitToLast()","Query.limitToLast()")}var e},n.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,dp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mp("startAt",t,!0)}.apply(void 0,t)))}catch(r){throw Wp(r,"startAt()","Query.startAt()")}},n.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,dp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mp("startAfter",t,!1)}.apply(void 0,t)))}catch(r){throw Wp(r,"startAfter()","Query.startAfter()")}},n.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,dp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bp("endBefore",t,!0)}.apply(void 0,t)))}catch(r){throw Wp(r,"endBefore()","Query.endBefore()")}},n.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new n(this.firestore,dp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bp("endAt",t,!1)}.apply(void 0,t)))}catch(r){throw Wp(r,"endAt()","Query.endAt()")}},n.prototype.isEqual=function(t){return pl(this.d_,t.d_)},n.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=nl(t,al);var e=nl(t.firestore,rp),n=ip(e),o=new kp(e);return function(t,e){var n=this,o=new Bu;return t._s.Ps((function(){return r(n,void 0,void 0,(function(){var n;return i(this,(function(s){switch(s.label){case 0:return n=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,a;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Fc(t,e,!0)];case 1:return a=i.sent(),r=new uf(e,a.Rc),o=r.fl(a.documents),s=r.wi(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=i.sent(),a=ea(u,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Xl(t)];case 1:return[2,n.apply(void 0,[s.sent(),e,o])]}}))}))})),o.promise}(n,t.C_).then((function(n){return new Op(e,o,t,n)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=nl(t,al);var e=nl(t.firestore,rp),n=ip(e),r=new kp(e);return tp(n,t.C_,{source:"server"}).then((function(n){return new Op(e,r,t,n)}))}(this.d_):function(t){t=nl(t,al);var e=nl(t.firestore,rp),n=ip(e),r=new kp(e);return lp(t.C_),tp(n,t.C_).then((function(n){return new Op(e,r,t,n)}))}(this.d_)).then((function(t){return new rd(e.firestore,new Op(e.firestore.d_,e.Xf,e.d_,t._d))}))},n.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Jp(e),i=Zp(e,(function(e){return new rd(t.firestore,new Op(t.firestore.d_,t.Xf,t.d_,e._d))}));return Lp(this.d_,r,i)},n.prototype.withConverter=function(t){return new n(this.firestore,t?this.d_.withConverter(Qp.gd(this.firestore,t)):this.d_.withConverter(null))},n}(Xf),nd=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return e(n,t),Object.defineProperty(n.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"doc",{get:function(){return new td(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),n}(Xf),rd=function(t){function n(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return e(n,t),Object.defineProperty(n.prototype,"query",{get:function(){return new ed(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map((function(e){return new td(t.Yf,e)}))},enumerable:!1,configurable:!0}),n.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map((function(t){return new nd(e.Yf,t)}))},n.prototype.forEach=function(t,e){var n=this;this.d_.forEach((function(r){t.call(e,new td(n.Yf,r))}))},n.prototype.isEqual=function(t){return Pp(this.d_,t.d_)},n}(Xf),id=function(t){function n(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.d_=n,r}return e(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new Xp(this.firestore,t):null},enumerable:!1,configurable:!0}),n.prototype.doc=function(t){try{return new Xp(this.firestore,void 0===t?fl(this.d_):fl(this.d_,t))}catch(e){throw Wp(e,"doc()","CollectionReference.doc()")}},n.prototype.add=function(t){var e,n,r,i,o,s=this;return(e=this.d_,n=t,r=nl(e.firestore,rp),i=fl(e),o=Tp(e.v_,n),Rp(r,[_l(El(e.firestore),"addDoc",i.S_,o,null!==e.v_,{}).F_(i.S_,gs.exists(!1))]).then((function(){return i}))).then((function(t){return new Xp(s.firestore,t)}))},n.prototype.isEqual=function(t){return ll(this.d_,t.d_)},n.prototype.withConverter=function(t){return new n(this.firestore,t?this.d_.withConverter(Qp.gd(this.firestore,t)):this.d_.withConverter(null))},n}(ed);function od(t){return t instanceof Xf&&(t=t.d_),nl(t,ul)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var sd,ud=function(t){function n(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Kf.bind.apply(Kf,s([void 0],e))))||this}return e(n,t),n.documentId=function(){return new n(Ci.ht().rt())},n.prototype.isEqual=function(t){return t instanceof Xf&&(t=t.d_),t instanceof Kf&&this.d_.f_.isEqual(t.f_)},n}(Xf),ad=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.serverTimestamp=function(){var t=new Nl("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new n(t)},n.delete=function(){var t=new Il("deleteField");return t._methodName="FieldValue.delete",new n(t)},n.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Al("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new n(r)},n.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sl("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new n(r)},n.increment=function(t){var e=new Dl("increment",t);return e._methodName="FieldValue.increment",new n(e)},n.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},n}(Xf),cd={Firestore:Gp,GeoPoint:dl,Timestamp:Di,Blob:zp,Transaction:Yp,WriteBatch:Kp,DocumentReference:Xp,DocumentSnapshot:$p,Query:ed,QueryDocumentSnapshot:td,QuerySnapshot:rd,CollectionReference:id,FieldPath:ud,FieldValue:ad,setLogLevel:function(t){var e;e=t,ri.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(sd=K).INTERNAL.registerComponent(new b("firestore",(function(t){return function(t,e){return new Gp(t,new rp(t,e),new Bp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},cd))),sd.registerVersion("@firebase/firestore","2.2.0");export{K as f};
